########################################################
Neural-Symbolic Inductive Learner (NSIL)
########################################################
Current machine date/time: 2023-01-06 14:01:38.301768
Running on device: cuda:0
Saving log and results to: results/repeats/CHS_fashion_mnist/100/5
Arguments: {'pct': 100, 'num_workers': 2, 'tune': False, 'logging': 'INFO', 'seed': 5657, 'num_iterations': 20, 'num_tuning_iterations': 2, 'explore_ex_lr': 1, 'exploit_ex_lr': 1, 'save_dir': 'results/repeats/CHS_fashion_mnist/100/5', 'skip_initial_testing': False, 'custom_eval_interval': 1, 'nesy_reasoner': 'NeurASP', 'lr': 0.001, 'net_batch_size': 64, 'num_net_epochs': 1, 'save_nets': True, 'ilp_system': 'ILASP', 'custom_ilp_cmd_line_args': None, 'prune_ilp_example_weight_threshold': 1, 'use_bootstrap_cache': False, 'pylasp': True, 'ilp_config': None, 'task_type': 'chs', 'image_type': 'fashion_mnist'}
Loading data...
Starting NSIL training loop...

##########
Iteration: 1
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_0jfzdoen results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_1.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Component: ILP, run time: 307.4862473011017
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Running testing for iteration: 0...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.175
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 0 test accuracy:
	End-to-end: 0.4430379746835443
	Network(s): {'digit': 0.175}
	Hypothesis: 0.9208860759493671
Confusion matrix for network digit:
[[  0   0  39   0 961]
 [  0   0  45   0 955]
 [  0   0  60   0 940]
 [  0   0  23   0 977]
 [  0   0 185   0 815]]
Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.019471883773804
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.95120620727539
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 17.34939759036145, 'template_2_label_0': 15.7556270096463, 'template_7_label_1': 0.0, 'template_3_label_0': 21.53846153846154, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.2889404296875
Performing exploitation...
Component: exploitation, run time: 5.819838285446167
Running testing for iteration: 1...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.821
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 1 test accuracy:
	End-to-end: 0.8955696202531646
	Network(s): {'digit': 0.821}
	Hypothesis: 0.9208860759493671
Confusion matrix for network digit:
[[938   1  55   5   1]
 [ 15 705  30 245   5]
 [ 18  28 853  95   6]
 [ 14 296  65 613  12]
 [  1   0   3   0 996]]

##########
Iteration: 2
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_gw_wie4g results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_2.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 189.08754181861877
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.78618574142456
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.998047113418579
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.8387096774193505, 'template_1_label_0': 8.674698795180724, 'template_2_label_0': 7.395498392282962, 'template_7_label_1': 0.0, 'template_3_label_0': 10.769230769230765, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 3.749999999999998, 'template_3_label_1': 27.27272727272727, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.551362752914429
Performing exploitation...
Component: exploitation, run time: 5.7148661613464355
Running testing for iteration: 2...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8622
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 2 test accuracy:
	End-to-end: 0.939873417721519
	Network(s): {'digit': 0.8622}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[939   1  56   3   1]
 [  1 755  55 189   0]
 [ 10  31 944  14   1]
 [  2 195 116 686   1]
 [  1   0  12   0 987]]

##########
Iteration: 3
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_hkblouaa results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_3.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 201.93082451820374
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.40196752548218
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.916479110717773
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 6.506024096385543, 'template_2_label_0': 5.787781350482312, 'template_7_label_1': 0.0, 'template_3_label_0': 9.999999999999998, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 36.36363636363637, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.36679983139038
Performing exploitation...
Component: exploitation, run time: 5.927409887313843
Running testing for iteration: 3...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.881
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 3 test accuracy:
	End-to-end: 0.939873417721519
	Network(s): {'digit': 0.881}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[948   0  48   3   1]
 [  0 741  64 194   1]
 [  9  20 950  18   3]
 [  2 132  94 771   1]
 [  0   0   5   0 995]]

##########
Iteration: 4
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_iye96bb1 results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_4.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 221.06487560272217
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.32763361930847
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.809738874435425
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 6.506024096385543, 'template_2_label_0': 5.1446945337620615, 'template_7_label_1': 0.0, 'template_3_label_0': 9.999999999999998, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 6.25, 'template_3_label_1': 27.27272727272727, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.718336582183838
Performing exploitation...
Component: exploitation, run time: 5.879174470901489
Running testing for iteration: 4...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8908
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 4 test accuracy:
	End-to-end: 0.9493670886075949
	Network(s): {'digit': 0.8908}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[949   0  47   3   1]
 [  2 762  57 179   0]
 [ 10  17 949  24   0]
 [  3 109  85 803   0]
 [  0   0   9   0 991]]

##########
Iteration: 5
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_relbr4bx results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_5.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 224.4755985736847
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.382516622543335
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.858007192611694
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.8387096774193505, 'template_1_label_0': 4.81927710843374, 'template_2_label_0': 4.180064308681675, 'template_7_label_1': 0.0, 'template_3_label_0': 9.999999999999998, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 6.25, 'template_3_label_1': 27.27272727272727, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.010217189788818
Performing exploitation...
Component: exploitation, run time: 5.684208869934082
Running testing for iteration: 5...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.895
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 5 test accuracy:
	End-to-end: 0.9462025316455697
	Network(s): {'digit': 0.895}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[958   0  39   3   0]
 [  1 779  49 171   0]
 [ 13  18 940  29   0]
 [  3 113  78 806   0]
 [  0   0   8   0 992]]

##########
Iteration: 6
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_675hjeop results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_6.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 246.10357904434204
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.905285358428955
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.91361689567566
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.8387096774193505, 'template_1_label_0': 5.060240963855422, 'template_2_label_0': 3.858520900321538, 'template_7_label_1': 0.0, 'template_3_label_0': 8.461538461538465, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.627360582351685
Performing exploitation...
Component: exploitation, run time: 5.769381523132324
Running testing for iteration: 6...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8996
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 6 test accuracy:
	End-to-end: 0.9493670886075949
	Network(s): {'digit': 0.8996}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[961   0  35   3   1]
 [  0 797  33 170   0]
 [ 12  27 922  39   0]
 [  2 114  58 825   1]
 [  0   1   6   0 993]]

##########
Iteration: 7
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_hc__wqeo results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_7.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 241.6938033103943
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.02775430679321
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.878718376159668
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.8387096774193505, 'template_1_label_0': 4.578313253012045, 'template_2_label_0': 3.858520900321538, 'template_7_label_1': 0.0, 'template_3_label_0': 9.230769230769232, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.113934993743896
Performing exploitation...
Component: exploitation, run time: 5.825065851211548
Running testing for iteration: 7...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9018
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 7 test accuracy:
	End-to-end: 0.9462025316455697
	Network(s): {'digit': 0.9018}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[962   0  35   3   0]
 [  0 788  29 182   1]
 [ 15  30 914  41   0]
 [  3  98  46 852   1]
 [  0   1   5   1 993]]

##########
Iteration: 8
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_leoo52bo results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_8.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 198.04331278800964
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.33826494216919
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.125571966171265
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.8387096774193505, 'template_1_label_0': 3.855421686746985, 'template_2_label_0': 4.8231511254019255, 'template_7_label_1': 0.0, 'template_3_label_0': 7.692307692307687, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.854496240615845
Performing exploitation...
Component: exploitation, run time: 5.8152992725372314
Running testing for iteration: 8...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9022
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 8 test accuracy:
	End-to-end: 0.9525316455696202
	Network(s): {'digit': 0.9022}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[963   0  31   5   1]
 [  1 784  20 195   0]
 [ 16  30 894  60   0]
 [  3  86  36 874   1]
 [  0   1   3   0 996]]

##########
Iteration: 9
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_mk7wpssn results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_9.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 233.13290643692017
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.41498351097107
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.833021879196167
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 4.578313253012045, 'template_2_label_0': 4.5016077170418, 'template_7_label_1': 0.0, 'template_3_label_0': 9.999999999999998, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 2.500000000000002, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.48545241355896
Performing exploitation...
Component: exploitation, run time: 5.735511541366577
Running testing for iteration: 9...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8992
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 9 test accuracy:
	End-to-end: 0.9462025316455697
	Network(s): {'digit': 0.8992}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[958   0  36   6   0]
 [  1 751  37 210   1]
 [  8  21 922  49   0]
 [  3  75  50 869   3]
 [  0   0   4   0 996]]

##########
Iteration: 10
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_s_x6cfr5 results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_10.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 222.57464361190796
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.28792214393616
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.09001088142395
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 3.855421686746985, 'template_2_label_0': 3.858520900321538, 'template_7_label_1': 0.0, 'template_3_label_0': 7.692307692307687, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 3.749999999999998, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.212324380874634
Performing exploitation...
Component: exploitation, run time: 5.986318111419678
Running testing for iteration: 10...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8974
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 10 test accuracy:
	End-to-end: 0.9430379746835443
	Network(s): {'digit': 0.8974}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[956   0  39   5   0]
 [  1 751  38 209   1]
 [  7  24 923  46   0]
 [  3  84  52 859   2]
 [  0   0   2   0 998]]

##########
Iteration: 11
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_cdicddws results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_11.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 190.85589623451233
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.29918193817139
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.814004898071289
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 3.1325301204819245, 'template_2_label_0': 4.5016077170418, 'template_7_label_1': 0.0, 'template_3_label_0': 7.692307692307687, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.619089126586914
Performing exploitation...
Component: exploitation, run time: 5.818149566650391
Running testing for iteration: 11...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.898
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 11 test accuracy:
	End-to-end: 0.9651898734177216
	Network(s): {'digit': 0.898}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[962   0  33   4   1]
 [  2 742  34 220   2]
 [  7  22 907  62   2]
 [  4  75  38 881   2]
 [  0   0   2   0 998]]

##########
Iteration: 12
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_wry9yiyg results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_12.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 227.39283394813538
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.347289085388184
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.949215650558472
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.8387096774193505, 'template_1_label_0': 2.409638554216864, 'template_2_label_0': 3.2154340836012874, 'template_7_label_1': 0.0, 'template_3_label_0': 7.692307692307687, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 6.25, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.84713625907898
Performing exploitation...
Component: exploitation, run time: 6.023566961288452
Running testing for iteration: 12...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8982
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 12 test accuracy:
	End-to-end: 0.9588607594936709
	Network(s): {'digit': 0.8982}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[974   0  19   7   0]
 [  3 744  26 226   1]
 [ 19  22 887  72   0]
 [  4  72  34 888   2]
 [  0   0   2   0 998]]

##########
Iteration: 13
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_g318pvm7 results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_13.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 251.33002376556396
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.017136335372925
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.986445188522339
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.6129032258064502, 'template_1_label_0': 4.0963855421686795, 'template_2_label_0': 5.1446945337620615, 'template_7_label_1': 0.0, 'template_3_label_0': 9.230769230769232, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 5.000000000000004, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.096613883972168
Performing exploitation...
Component: exploitation, run time: 6.024536848068237
Running testing for iteration: 13...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8976
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 13 test accuracy:
	End-to-end: 0.9462025316455697
	Network(s): {'digit': 0.8976}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 949    1   44    5    1]
 [   1  790   26  175    8]
 [   6   27  900   60    7]
 [   3  102   36  849   10]
 [   0    0    0    0 1000]]

##########
Iteration: 14
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_qgykuvqi results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_14.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 231.2374632358551
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.24375677108765
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.032341718673706
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.6129032258064502, 'template_1_label_0': 2.168674698795181, 'template_2_label_0': 3.5369774919614128, 'template_7_label_1': 0.0, 'template_3_label_0': 5.384615384615388, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 3.749999999999998, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.84593677520752
Performing exploitation...
Component: exploitation, run time: 6.197774410247803
Running testing for iteration: 14...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8966
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 14 test accuracy:
	End-to-end: 0.9588607594936709
	Network(s): {'digit': 0.8966}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[971   1  22   6   0]
 [  3 751  20 226   0]
 [ 22  28 887  63   0]
 [  4  76  42 877   1]
 [  0   1   2   0 997]]

##########
Iteration: 15
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_7aja_3hg results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_15.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 240.6782569885254
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.20742321014404
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.29877519607544
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 2.168674698795181, 'template_2_label_0': 2.893890675241162, 'template_7_label_1': 0.0, 'template_3_label_0': 5.384615384615388, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 1.2499999999999956, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.738205671310425
Performing exploitation...
Component: exploitation, run time: 5.8001604080200195
Running testing for iteration: 15...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8958
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 15 test accuracy:
	End-to-end: 0.9651898734177216
	Network(s): {'digit': 0.8958}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[972   1  23   4   0]
 [  2 736  27 232   3]
 [ 14  20 901  64   1]
 [  3  81  43 871   2]
 [  0   0   1   0 999]]

##########
Iteration: 16
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_nqmyf9w2 results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_16.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 226.41889429092407
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.3655219078064
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.016381978988647
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.2258064516129004, 'template_1_label_0': 1.6867469879518038, 'template_2_label_0': 2.893890675241162, 'template_7_label_1': 0.0, 'template_3_label_0': 3.8461538461538436, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 8.750000000000002, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.14777135848999
Performing exploitation...
Component: exploitation, run time: 5.9253270626068115
Running testing for iteration: 16...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 16 test accuracy:
	End-to-end: 0.9683544303797469
	Network(s): {'digit': 0.9}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 972    0   21    6    1]
 [   1  778   19  201    1]
 [  20   29  883   64    4]
 [   4   90   35  867    4]
 [   0    0    0    0 1000]]

##########
Iteration: 17
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_u5yflbj6 results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_17.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 236.65459084510803
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.83271551132202
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.141935586929321
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 0.0, 'template_1_label_0': 4.578313253012045, 'template_2_label_0': 5.1446945337620615, 'template_7_label_1': 0.0, 'template_3_label_0': 9.999999999999998, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 3.749999999999998, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 11.695595502853394
Performing exploitation...
Component: exploitation, run time: 5.8418121337890625
Running testing for iteration: 17...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8856
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 17 test accuracy:
	End-to-end: 0.9335443037974683
	Network(s): {'digit': 0.8856}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[916   0  80   4   0]
 [  1 744  38 216   1]
 [  2  19 918  60   1]
 [  4  92  48 853   3]
 [  0   0   2   1 997]]

##########
Iteration: 18
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_3z0u41ll results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_18.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 216.33398365974426
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.74261426925659
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.79270315170288
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.6129032258064502, 'template_1_label_0': 2.409638554216864, 'template_2_label_0': 3.858520900321538, 'template_7_label_1': 0.0, 'template_3_label_0': 3.8461538461538436, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 3.749999999999998, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.457938432693481
Performing exploitation...
Component: exploitation, run time: 5.607016563415527
Running testing for iteration: 18...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8966
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 18 test accuracy:
	End-to-end: 0.9651898734177216
	Network(s): {'digit': 0.8966}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 977    1   15    6    1]
 [   3  837   16  144    0]
 [  29   33  855   79    4]
 [   5  152   27  814    2]
 [   0    0    0    0 1000]]

##########
Iteration: 19
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_o1z_vjqr results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_19.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 243.6741132736206
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 34.71668028831482
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.511666774749756
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.6129032258064502, 'template_1_label_0': 2.168674698795181, 'template_2_label_0': 2.893890675241162, 'template_7_label_1': 0.0, 'template_3_label_0': 4.61538461538461, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 1.2499999999999956, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.100375890731812
Performing exploitation...
Component: exploitation, run time: 6.261247634887695
Running testing for iteration: 19...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.894
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 19 test accuracy:
	End-to-end: 0.9620253164556962
	Network(s): {'digit': 0.894}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 974    2   20    3    1]
 [   4  771   24  199    2]
 [  25   22  889   59    5]
 [   3  106   51  836    4]
 [   0    0    0    0 1000]]

##########
Iteration: 20
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_o0dzftug results/repeats/CHS_fashion_mnist/100/5/pylasp/iteration_20.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 249.75341176986694
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 34.40485644340515
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.705671548843384
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.6129032258064502, 'template_1_label_0': 1.927710843373498, 'template_2_label_0': 3.5369774919614128, 'template_7_label_1': 0.0, 'template_3_label_0': 5.384615384615388, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_2_label_1': 2.500000000000002, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 13.42381739616394
Performing exploitation...
Component: exploitation, run time: 7.8846118450164795
Running testing for iteration: 20...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8942
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 20 test accuracy:
	End-to-end: 0.9588607594936709
	Network(s): {'digit': 0.8942}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[963   1  32   3   1]
 [  2 771  33 194   0]
 [ 12  18 911  55   4]
 [  3 109  58 827   3]
 [  0   0   1   0 999]]
