########################################################
Neural-Symbolic Inductive Learner (NSIL)
########################################################
Current machine date/time: 2023-01-07 01:53:08.110171
Running on device: cuda:0
Saving log and results to: results/repeats/HS_fashion_mnist/100/16
Arguments: {'pct': 100, 'num_workers': 2, 'tune': False, 'logging': 'INFO', 'seed': 5093, 'num_iterations': 20, 'num_tuning_iterations': 2, 'explore_ex_lr': 1, 'exploit_ex_lr': 1, 'save_dir': 'results/repeats/HS_fashion_mnist/100/16', 'skip_initial_testing': False, 'custom_eval_interval': 1, 'nesy_reasoner': 'NeurASP', 'lr': 0.001, 'net_batch_size': 64, 'num_net_epochs': 1, 'save_nets': True, 'ilp_system': 'ILASP', 'custom_ilp_cmd_line_args': None, 'prune_ilp_example_weight_threshold': 1, 'use_bootstrap_cache': False, 'pylasp': True, 'ilp_config': None, 'task_type': 'hs', 'image_type': 'fashion_mnist'}
Loading data...
Starting NSIL training loop...

##########
Iteration: 1
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_a1_87jin results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_1.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Component: ILP, run time: 249.89264512062073
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Running testing for iteration: 0...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.2
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 0 test accuracy:
	End-to-end: 0.569620253164557
	Network(s): {'digit': 0.2}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[   0 1000    0    0    0]
 [   0 1000    0    0    0]
 [   0 1000    0    0    0]
 [   0 1000    0    0    0]
 [   0 1000    0    0    0]]
Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 26.423410654067993
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.224621534347534
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 78.0, 'template_2_label_0': 7.619047619047614, 'template_1_label_0': 10.397553516819569, 'template_7_label_1': 0.0, 'template_2_label_1': 75.13812154696133, 'template_3_label_0': 12.037037037037035, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 81.81818181818181, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.057213068008423
Performing exploitation...
Component: exploitation, run time: 6.2181243896484375
Running testing for iteration: 1...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.7292
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 1 test accuracy:
	End-to-end: 0.7974683544303798
	Network(s): {'digit': 0.7292}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[966   1  28   5   0]
 [387 422  19 170   2]
 [162  32 675 126   5]
 [ 87 290  31 589   3]
 [  0   0   6   0 994]]

##########
Iteration: 2
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_z0n_f_9b results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_2.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 255.02421069145203
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.662917613983154
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.067204475402832
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.666666666666665, 'template_2_label_0': 24.28571428571429, 'template_1_label_0': 28.74617737003058, 'template_7_label_1': 0.0, 'template_2_label_1': 8.83977900552486, 'template_3_label_0': 25.92592592592593, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 12.389482259750366
Performing exploitation...
Component: exploitation, run time: 5.834887504577637
Running testing for iteration: 2...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8684
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 2 test accuracy:
	End-to-end: 0.8607594936708861
	Network(s): {'digit': 0.8684}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[942   5  49   2   2]
 [  1 671  57 266   5]
 [ 10  15 949  19   7]
 [  3  87 123 781   6]
 [  0   0   1   0 999]]

##########
Iteration: 3
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file__mir7aef results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_3.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 289.404842376709
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.71408796310425
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.647899627685547
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.666666666666665, 'template_2_label_0': 20.952380952380956, 'template_1_label_0': 26.60550458715596, 'template_7_label_1': 0.0, 'template_2_label_1': 9.944751381215466, 'template_3_label_0': 26.851851851851848, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 21.212121212121215, 'template_0_label_0': 1.8867924528301883}
Component: exploration, run time: 11.585976839065552
Performing exploitation...
Component: exploitation, run time: 5.816554069519043
Running testing for iteration: 3...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.877
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 3 test accuracy:
	End-to-end: 0.8734177215189873
	Network(s): {'digit': 0.877}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[951   4  42   3   0]
 [  2 656  55 285   2]
 [  7  14 945  33   1]
 [  1  68  94 835   2]
 [  0   0   2   0 998]]

##########
Iteration: 4
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_zxgmg_yn results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_4.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 291.3465750217438
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.42222571372986
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.420555591583252
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 5.333333333333334, 'template_2_label_0': 18.0952380952381, 'template_1_label_0': 21.712538226299692, 'template_7_label_1': 0.0, 'template_2_label_1': 8.83977900552486, 'template_3_label_0': 19.444444444444443, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 21.212121212121215, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 11.80910038948059
Performing exploitation...
Component: exploitation, run time: 5.613764524459839
Running testing for iteration: 4...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8898
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 4 test accuracy:
	End-to-end: 0.8860759493670886
	Network(s): {'digit': 0.8898}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[954   3  40   3   0]
 [  2 713  35 249   1]
 [  6  19 935  39   1]
 [  1  72  76 849   2]
 [  0   0   2   0 998]]

##########
Iteration: 5
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_hbs7dte8 results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_5.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 270.67069911956787
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.53982162475586
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.494393825531006
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.666666666666663, 'template_2_label_0': 13.809523809523805, 'template_1_label_0': 18.04281345565749, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 19.444444444444443, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 21.212121212121215, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 11.598870038986206
Performing exploitation...
Component: exploitation, run time: 5.908046722412109
Running testing for iteration: 5...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9022
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 5 test accuracy:
	End-to-end: 0.8892405063291139
	Network(s): {'digit': 0.9022}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[960   2  35   3   0]
 [  2 758  27 212   1]
 [  7  21 934  38   0]
 [  1  79  59 861   0]
 [  0   0   2   0 998]]

##########
Iteration: 6
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_xbb10f_e results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_6.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 309.4477252960205
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.734116077423096
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.7188401222229
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 7.333333333333336, 'template_2_label_0': 14.28571428571429, 'template_1_label_0': 18.04281345565749, 'template_7_label_1': 0.0, 'template_2_label_1': 8.83977900552486, 'template_3_label_0': 17.59259259259259, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 21.212121212121215, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.307575464248657
Performing exploitation...
Component: exploitation, run time: 6.014905214309692
Running testing for iteration: 6...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8996
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 6 test accuracy:
	End-to-end: 0.8829113924050633
	Network(s): {'digit': 0.8996}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[950   2  43   5   0]
 [  1 747  22 229   1]
 [  2  22 921  54   1]
 [  0  72  47 881   0]
 [  0   0   1   0 999]]

##########
Iteration: 7
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_daiztd5y results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_7.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 307.33025908470154
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.748979330062866
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.860057592391968
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 5.333333333333334, 'template_2_label_0': 15.238095238095239, 'template_1_label_0': 15.290519877675845, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 17.59259259259259, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 12.345972299575806
Performing exploitation...
Component: exploitation, run time: 6.217911005020142
Running testing for iteration: 7...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9064
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 7 test accuracy:
	End-to-end: 0.8734177215189873
	Network(s): {'digit': 0.9064}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[960   2  35   3   0]
 [  1 799  21 178   1]
 [  3  25 920  51   1]
 [  2  97  46 854   1]
 [  0   0   1   0 999]]

##########
Iteration: 8
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_afyeu1cv results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_8.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 314.73586225509644
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.57759714126587
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 17.60531234741211
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 5.333333333333334, 'template_2_label_0': 14.761904761904765, 'template_1_label_0': 14.678899082568808, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.515851497650146
Performing exploitation...
Component: exploitation, run time: 6.1077094078063965
Running testing for iteration: 8...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9048
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 8 test accuracy:
	End-to-end: 0.8765822784810127
	Network(s): {'digit': 0.9048}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[956   2  40   2   0]
 [  0 791  21 187   1]
 [  3  26 921  49   1]
 [  2  93  47 857   1]
 [  0   0   1   0 999]]

##########
Iteration: 9
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_n4zfl43c results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_9.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 303.509526014328
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.32070302963257
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.926687717437744
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 11.428571428571432, 'template_1_label_0': 15.290519877675845, 'template_7_label_1': 0.0, 'template_2_label_1': 7.182320441988955, 'template_3_label_0': 17.59259259259259, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.331905364990234
Performing exploitation...
Component: exploitation, run time: 6.135620355606079
Running testing for iteration: 9...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9026
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 9 test accuracy:
	End-to-end: 0.8734177215189873
	Network(s): {'digit': 0.9026}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[956   3  39   2   0]
 [  0 764  22 213   1]
 [  6  24 916  52   2]
 [  2  74  45 878   1]
 [  0   0   1   0 999]]

##########
Iteration: 10
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_eq3dj7rl results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_10.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 315.68353629112244
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.44480848312378
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 17.43099021911621
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 11.428571428571432, 'template_1_label_0': 14.37308868501529, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 16.666666666666664, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.065232753753662
Performing exploitation...
Component: exploitation, run time: 5.6084465980529785
Running testing for iteration: 10...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9034
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 10 test accuracy:
	End-to-end: 0.8892405063291139
	Network(s): {'digit': 0.9034}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[960   5  31   4   0]
 [  0 777  15 207   1]
 [  9  28 904  58   1]
 [  2  79  42 877   0]
 [  0   0   1   0 999]]

##########
Iteration: 11
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_87ai09pi results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_11.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 287.47680258750916
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.6314902305603
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.291616201400757
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 9.999999999999998, 'template_1_label_0': 13.455657492354744, 'template_7_label_1': 0.0, 'template_2_label_1': 5.524861878453036, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.903553247451782
Performing exploitation...
Component: exploitation, run time: 5.766580820083618
Running testing for iteration: 11...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9068
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 11 test accuracy:
	End-to-end: 0.8987341772151899
	Network(s): {'digit': 0.9068}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[969   3  24   4   0]
 [  2 800  15 182   1]
 [ 12  33 895  60   0]
 [  2  89  38 871   0]
 [  0   0   1   0 999]]

##########
Iteration: 12
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_7sf36swb results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_12.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 309.7361173629761
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.347572326660156
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 17.802384853363037
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 9.999999999999998, 'template_1_label_0': 11.620795107033643, 'template_7_label_1': 0.0, 'template_2_label_1': 5.524861878453036, 'template_3_label_0': 16.666666666666664, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.769807577133179
Performing exploitation...
Component: exploitation, run time: 6.142929792404175
Running testing for iteration: 12...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9048
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 12 test accuracy:
	End-to-end: 0.8892405063291139
	Network(s): {'digit': 0.9048}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[965   2  29   4   0]
 [  1 776  20 202   1]
 [  8  32 910  48   2]
 [  2  73  50 874   1]
 [  0   0   1   0 999]]

##########
Iteration: 13
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_f8thdpna results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_13.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 333.89308619499207
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.227553367614746
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.022898435592651
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 8.571428571428575, 'template_1_label_0': 12.844036697247708, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.651816368103027
Performing exploitation...
Component: exploitation, run time: 5.753492593765259
Running testing for iteration: 13...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.906
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 13 test accuracy:
	End-to-end: 0.8892405063291139
	Network(s): {'digit': 0.906}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[974   5  18   3   0]
 [  1 826   9 161   3]
 [ 22  49 873  54   2]
 [  3 103  34 858   2]
 [  0   0   1   0 999]]

##########
Iteration: 14
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_x71n66hh results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_14.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 254.09729146957397
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.21953988075256
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 17.269116163253784
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.3333333333333308, 'template_2_label_0': 9.04761904761905, 'template_1_label_0': 10.703363914373087, 'template_7_label_1': 0.0, 'template_2_label_1': 2.7624309392265234, 'template_3_label_0': 11.111111111111116, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.675840616226196
Performing exploitation...
Component: exploitation, run time: 5.51776909828186
Running testing for iteration: 14...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.91
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 14 test accuracy:
	End-to-end: 0.8892405063291139
	Network(s): {'digit': 0.91}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[965   5  27   3   0]
 [  1 842  13 143   1]
 [ 10  40 904  45   1]
 [  2 109  48 840   1]
 [  0   0   1   0 999]]

##########
Iteration: 15
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_dir59s7n results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_15.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 284.0287296772003
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.52442979812622
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.624038457870483
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 9.04761904761905, 'template_1_label_0': 11.314984709480125, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 12.037037037037035, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.738813638687134
Performing exploitation...
Component: exploitation, run time: 5.923929214477539
Running testing for iteration: 15...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9046
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 15 test accuracy:
	End-to-end: 0.8955696202531646
	Network(s): {'digit': 0.9046}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[959   5  31   5   0]
 [  1 829  13 156   1]
 [ 13  48 887  51   1]
 [  2 110  38 850   0]
 [  0   1   0   1 998]]

##########
Iteration: 16
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_wrs70xkd results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_16.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 286.8416838645935
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.9193696975708
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.153670072555542
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 9.04761904761905, 'template_1_label_0': 11.314984709480125, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 13.888888888888884, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.754981994628906
Performing exploitation...
Component: exploitation, run time: 6.152202367782593
Running testing for iteration: 16...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9038
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 16 test accuracy:
	End-to-end: 0.8924050632911392
	Network(s): {'digit': 0.9038}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[950   7  37   6   0]
 [  1 825  14 155   5]
 [  2  46 895  55   2]
 [  1 109  38 850   2]
 [  0   0   1   0 999]]

##########
Iteration: 17
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_4iwknpnw results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_17.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 331.8550684452057
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.72515296936035
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.444098711013794
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 9.999999999999998, 'template_1_label_0': 10.09174311926605, 'template_7_label_1': 0.0, 'template_2_label_1': 5.524861878453036, 'template_3_label_0': 11.111111111111116, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.936400175094604
Performing exploitation...
Component: exploitation, run time: 5.757556438446045
Running testing for iteration: 17...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9034
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 17 test accuracy:
	End-to-end: 0.8955696202531646
	Network(s): {'digit': 0.9034}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[948   8  41   3   0]
 [  0 869  20 109   2]
 [  3  44 913  39   1]
 [  2 165  44 789   0]
 [  0   0   2   0 998]]

##########
Iteration: 18
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_do4f3upv results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_18.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 314.24094414711
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.248265981674194
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.110853433609009
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 6.190476190476191, 'template_1_label_0': 9.174311926605505, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 9.259259259259256, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.85511565208435
Performing exploitation...
Component: exploitation, run time: 5.882121801376343
Running testing for iteration: 18...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.903
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 18 test accuracy:
	End-to-end: 0.879746835443038
	Network(s): {'digit': 0.903}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[965   7  24   4   0]
 [  1 853  11 132   3]
 [ 15  58 886  40   1]
 [  2 145  40 812   1]
 [  0   0   1   0 999]]

##########
Iteration: 19
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_vd1so4r4 results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_19.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 318.5619378089905
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.23585844039917
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.36079454421997
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 7.14285714285714, 'template_1_label_0': 11.620795107033643, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 11.111111111111116, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.820290088653564
Performing exploitation...
Component: exploitation, run time: 5.823669195175171
Running testing for iteration: 19...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9042
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 19 test accuracy:
	End-to-end: 0.9018987341772152
	Network(s): {'digit': 0.9042}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[957   5  36   2   0]
 [  2 841  31 124   2]
 [  6  23 934  36   1]
 [  3 151  54 792   0]
 [  0   0   3   0 997]]

##########
Iteration: 20
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_saly7xye results/repeats/HS_fashion_mnist/100/16/pylasp/iteration_20.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 279.19781708717346
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.427621364593506
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.934916019439697
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 6.666666666666665, 'template_1_label_0': 8.868501529051986, 'template_7_label_1': 0.0, 'template_2_label_1': 4.41988950276243, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.894600868225098
Performing exploitation...
Component: exploitation, run time: 6.172371864318848
Running testing for iteration: 20...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8956
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 20 test accuracy:
	End-to-end: 0.8860759493670886
	Network(s): {'digit': 0.8956}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 947    7   41    5    0]
 [   2  764   10  221    3]
 [   2   53  874   65    6]
 [   0   71   34  893    2]
 [   0    0    0    0 1000]]
