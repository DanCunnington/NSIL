########################################################
Neural-Symbolic Inductive Learner (NSIL)
########################################################
Current machine date/time: 2023-01-06 06:33:51.885698
Running on device: cuda:0
Saving log and results to: results/repeats/HS_fashion_mnist/100/2
Arguments: {'pct': 100, 'num_workers': 2, 'tune': False, 'logging': 'INFO', 'seed': 6670, 'num_iterations': 20, 'num_tuning_iterations': 2, 'explore_ex_lr': 1, 'exploit_ex_lr': 1, 'save_dir': 'results/repeats/HS_fashion_mnist/100/2', 'skip_initial_testing': False, 'custom_eval_interval': 1, 'nesy_reasoner': 'NeurASP', 'lr': 0.001, 'net_batch_size': 64, 'num_net_epochs': 1, 'save_nets': True, 'ilp_system': 'ILASP', 'custom_ilp_cmd_line_args': None, 'prune_ilp_example_weight_threshold': 1, 'use_bootstrap_cache': False, 'pylasp': True, 'ilp_config': None, 'task_type': 'hs', 'image_type': 'fashion_mnist'}
Loading data...
Starting NSIL training loop...

##########
Iteration: 1
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_6mor7uaw results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_1.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Component: ILP, run time: 252.87727403640747
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Running testing for iteration: 0...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.2338
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 0 test accuracy:
	End-to-end: 0.569620253164557
	Network(s): {'digit': 0.2338}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[  0  52 924  24   0]
 [  0 470 502  28   0]
 [  0 226 684  90   0]
 [  0 452 533  15   0]
 [  0 460 299 241   0]]
Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 24.36287760734558
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.275016069412231
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 84.0, 'template_2_label_0': 6.666666666666665, 'template_1_label_0': 9.174311926605505, 'template_7_label_1': 0.0, 'template_2_label_1': 74.58563535911603, 'template_3_label_0': 11.111111111111116, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 84.84848484848484, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.531171560287476
Performing exploitation...
Component: exploitation, run time: 5.656713008880615
Running testing for iteration: 1...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.7126
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 1 test accuracy:
	End-to-end: 0.8006329113924051
	Network(s): {'digit': 0.7126}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[950   0  43   5   2]
 [490 309  24 176   1]
 [ 53  31 812  98   6]
 [190 254  56 497   3]
 [  1   0   4   0 995]]

##########
Iteration: 2
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_igiyt9ib results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_2.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).
 :- ss_element(3,V2); ss_element(V1,1); not hit(V3); ss(V3); elt(V2); ss(V1).
hit(V1) :- hs(V3,V2); ss_element(3,V2); hs_index(V3); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- ss_element(V3,V2); ss_element(V3,1); ss(V3); elt(V2); hs_index(V1).

Component: ILP, run time: 236.0924530029297
Converted hypothesis for neural-symbolic reasoning:
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).
 :- ss_element(3,V2); ss_element(V1,1); not hit(V3); ss(V3); elt(V2); ss(V1).
hit(V1) :- hs(V3,V2); ss_element(3,V2); hs_index(V3); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- ss_element(V3,V2); ss_element(V3,1); ss(V3); elt(V2); hs_index(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 29.063470602035522
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 13.958624124526978
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 38.0, 'template_2_label_0': 20.47619047619048, 'template_1_label_0': 25.076452599388375, 'template_7_label_1': 0.0, 'template_2_label_1': 49.17127071823204, 'template_3_label_0': 24.07407407407407, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 66.66666666666667, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 11.14960765838623
Performing exploitation...
Component: exploitation, run time: 5.78623366355896
Running testing for iteration: 2...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8642
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 2 test accuracy:
	End-to-end: 0.8164556962025317
	Network(s): {'digit': 0.8642}
	Hypothesis: 0.8227848101265823
Confusion matrix for network digit:
[[959   1  35   4   1]
 [ 33 727  42 196   2]
 [ 16  28 902  50   4]
 [ 13 177  68 738   4]
 [  0   0   5   0 995]]

##########
Iteration: 3
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_cara0mj0 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_3.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 193.5082745552063
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.775187492370605
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.238564491271973
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.000000000000005, 'template_2_label_0': 23.33333333333333, 'template_1_label_0': 26.29969418960245, 'template_7_label_1': 0.0, 'template_2_label_1': 8.83977900552486, 'template_3_label_0': 22.22222222222222, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 10.865029573440552
Performing exploitation...
Component: exploitation, run time: 6.023051023483276
Running testing for iteration: 3...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8758
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 3 test accuracy:
	End-to-end: 0.8607594936708861
	Network(s): {'digit': 0.8758}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 933    7   56    3    1]
 [   0  695   57  244    4]
 [   3   12  955   23    7]
 [   4   88  108  796    4]
 [   0    0    0    0 1000]]

##########
Iteration: 4
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_ein_id81 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_4.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 290.1215326786041
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 31.84686279296875
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 13.574875831604004
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 8.666666666666668, 'template_2_label_0': 20.47619047619048, 'template_1_label_0': 21.100917431192656, 'template_7_label_1': 0.0, 'template_2_label_1': 9.392265193370164, 'template_3_label_0': 20.370370370370374, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.155699968338013
Performing exploitation...
Component: exploitation, run time: 5.884169340133667
Running testing for iteration: 4...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8932
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 4 test accuracy:
	End-to-end: 0.8734177215189873
	Network(s): {'digit': 0.8932}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[944   1  49   6   0]
 [  1 758  31 209   1]
 [  9  21 925  45   0]
 [  2  95  60 842   1]
 [  0   0   3   0 997]]

##########
Iteration: 5
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_vii7xuqw results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_5.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 264.2349498271942
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.09058237075806
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 13.930109024047852
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 7.9999999999999964, 'template_2_label_0': 16.666666666666664, 'template_1_label_0': 17.125382262996947, 'template_7_label_1': 0.0, 'template_2_label_1': 8.287292817679559, 'template_3_label_0': 19.444444444444443, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.66976022720337
Performing exploitation...
Component: exploitation, run time: 5.780389308929443
Running testing for iteration: 5...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8982
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 5 test accuracy:
	End-to-end: 0.8607594936708861
	Network(s): {'digit': 0.8982}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[948   2  44   6   0]
 [  0 793  31 176   0]
 [ 12  22 916  50   0]
 [  2 107  53 837   1]
 [  0   0   3   0 997]]

##########
Iteration: 6
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_r9gparf8 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_6.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 288.2298250198364
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 32.979395627975464
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.50577187538147
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 7.333333333333336, 'template_2_label_0': 14.761904761904765, 'template_1_label_0': 15.290519877675845, 'template_7_label_1': 0.0, 'template_2_label_1': 7.734806629834257, 'template_3_label_0': 20.370370370370374, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.445390939712524
Performing exploitation...
Component: exploitation, run time: 5.646044492721558
Running testing for iteration: 6...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.901
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 6 test accuracy:
	End-to-end: 0.8734177215189873
	Network(s): {'digit': 0.901}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[958   2  34   5   1]
 [  2 813  25 159   1]
 [ 18  28 896  58   0]
 [  2 113  44 840   1]
 [  0   0   2   0 998]]

##########
Iteration: 7
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_7fweo_3k results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_7.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 277.5285074710846
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.4778254032135
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.4419584274292
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 7.9999999999999964, 'template_2_label_0': 13.33333333333333, 'template_1_label_0': 13.761467889908252, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 18.518518518518523, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.255457162857056
Performing exploitation...
Component: exploitation, run time: 5.346020460128784
Running testing for iteration: 7...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9024
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 7 test accuracy:
	End-to-end: 0.8765822784810127
	Network(s): {'digit': 0.9024}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[954   5  35   5   1]
 [  0 790  24 185   1]
 [  5  22 906  61   6]
 [  1  93  40 863   3]
 [  0   0   1   0 999]]

##########
Iteration: 8
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_ojh0ye3b results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_8.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 273.63122725486755
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.264209508895874
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.48833155632019
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 7.9999999999999964, 'template_2_label_0': 12.380952380952381, 'template_1_label_0': 14.984709480122326, 'template_7_label_1': 0.0, 'template_2_label_1': 5.524861878453036, 'template_3_label_0': 17.59259259259259, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.275323390960693
Performing exploitation...
Component: exploitation, run time: 5.586130142211914
Running testing for iteration: 8...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9046
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 8 test accuracy:
	End-to-end: 0.8639240506329114
	Network(s): {'digit': 0.9046}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[957   2  34   6   1]
 [  0 778  29 193   0]
 [  9  20 904  67   0]
 [  2  79  34 885   0]
 [  0   0   1   0 999]]

##########
Iteration: 9
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_jxelb01c results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_9.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 274.0492408275604
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.056851625442505
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.242135524749756
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 5.333333333333334, 'template_2_label_0': 10.952380952380958, 'template_1_label_0': 14.37308868501529, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.487263202667236
Performing exploitation...
Component: exploitation, run time: 5.703732490539551
Running testing for iteration: 9...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9038
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 9 test accuracy:
	End-to-end: 0.8765822784810127
	Network(s): {'digit': 0.9038}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 958    1   36    4    1]
 [   3  778   32  186    1]
 [  11   16  908   62    3]
 [   3   75   46  875    1]
 [   0    0    0    0 1000]]

##########
Iteration: 10
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_oacf6xt_ results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_10.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 267.53893637657166
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.380089044570923
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.264277696609497
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.000000000000005, 'template_2_label_0': 12.857142857142856, 'template_1_label_0': 14.37308868501529, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 14.814814814814813, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.323354721069336
Performing exploitation...
Component: exploitation, run time: 5.595308780670166
Running testing for iteration: 10...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9024
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 10 test accuracy:
	End-to-end: 0.8829113924050633
	Network(s): {'digit': 0.9024}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 965    2   29    3    1]
 [   2  764   26  208    0]
 [  16   19  896   65    4]
 [   2   65   46  887    0]
 [   0    0    0    0 1000]]

##########
Iteration: 11
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_me8rcugw results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_11.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 282.1501350402832
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.571512460708618
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.341034412384033
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 5.333333333333334, 'template_2_label_0': 12.857142857142856, 'template_1_label_0': 15.596330275229352, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 20.370370370370374, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 10.974761247634888
Performing exploitation...
Component: exploitation, run time: 5.575770854949951
Running testing for iteration: 11...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8964
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 11 test accuracy:
	End-to-end: 0.8607594936708861
	Network(s): {'digit': 0.8964}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 959    3   32    3    3]
 [   2  764   26  205    3]
 [   8   18  890   59   25]
 [   1   77   47  869    6]
 [   0    0    0    0 1000]]

##########
Iteration: 12
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_bnal2q1p results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_12.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 271.192786693573
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.02909255027771
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 13.917447090148926
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.666666666666663, 'template_2_label_0': 13.809523809523805, 'template_1_label_0': 14.37308868501529, 'template_7_label_1': 0.0, 'template_2_label_1': 4.972375690607733, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 10.946980237960815
Performing exploitation...
Component: exploitation, run time: 5.4367995262146
Running testing for iteration: 12...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8998
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 12 test accuracy:
	End-to-end: 0.8765822784810127
	Network(s): {'digit': 0.8998}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 955    2   38    4    1]
 [   3  760   20  216    1]
 [  13   24  894   62    7]
 [   1   61   46  890    2]
 [   0    0    0    0 1000]]

##########
Iteration: 13
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_db6qyxpv results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_13.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 282.3145501613617
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.357289791107178
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.25579309463501
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.000000000000005, 'template_2_label_0': 13.33333333333333, 'template_1_label_0': 16.81957186544343, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 15.740740740740744, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.017624855041504
Performing exploitation...
Component: exploitation, run time: 5.57206654548645
Running testing for iteration: 13...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8968
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 13 test accuracy:
	End-to-end: 0.870253164556962
	Network(s): {'digit': 0.8968}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 950    4   35   10    1]
 [   3  734   26  236    1]
 [   6   21  903   65    5]
 [   0   56   46  897    1]
 [   0    0    0    0 1000]]

##########
Iteration: 14
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_1vkq5jvv results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_14.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 267.5939540863037
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.328916549682617
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.31796407699585
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 12.380952380952381, 'template_1_label_0': 14.067278287461772, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 12.962962962962965, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.23010778427124
Performing exploitation...
Component: exploitation, run time: 5.444969415664673
Running testing for iteration: 14...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8976
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 14 test accuracy:
	End-to-end: 0.8829113924050633
	Network(s): {'digit': 0.8976}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 953    3   39    4    1]
 [   3  763   37  194    3]
 [   9   14  932   42    3]
 [   1   73   84  840    2]
 [   0    0    0    0 1000]]

##########
Iteration: 15
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_2oe32yi7 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_15.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 262.55340695381165
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.268544673919678
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.615407943725586
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.666666666666663, 'template_2_label_0': 13.809523809523805, 'template_1_label_0': 16.81957186544343, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 14.814814814814813, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.554895877838135
Performing exploitation...
Component: exploitation, run time: 5.6848320960998535
Running testing for iteration: 15...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8982
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 15 test accuracy:
	End-to-end: 0.8607594936708861
	Network(s): {'digit': 0.8982}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[963   1  30   5   1]
 [  5 728  31 236   0]
 [ 11  15 924  47   3]
 [  5  55  62 877   1]
 [  0   0   1   0 999]]

##########
Iteration: 16
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_t03id4oa results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_16.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 275.16954827308655
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.845322370529175
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.153777837753296
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.6666666666666616, 'template_2_label_0': 10.476190476190473, 'template_1_label_0': 11.009174311926607, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 12.962962962962965, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.052852392196655
Performing exploitation...
Component: exploitation, run time: 5.792874097824097
Running testing for iteration: 16...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9016
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 16 test accuracy:
	End-to-end: 0.8512658227848101
	Network(s): {'digit': 0.9016}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 961    6   26    6    1]
 [   5  797   26  171    1]
 [  17   22  904   51    6]
 [   3   91   58  846    2]
 [   0    0    0    0 1000]]

##########
Iteration: 17
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_curqqro0 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_17.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 264.1581997871399
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.112364053726196
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.716942548751831
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.666666666666663, 'template_2_label_0': 11.904761904761907, 'template_1_label_0': 11.620795107033643, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 13.888888888888884, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 10.648590564727783
Performing exploitation...
Component: exploitation, run time: 5.386938095092773
Running testing for iteration: 17...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9036
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 17 test accuracy:
	End-to-end: 0.879746835443038
	Network(s): {'digit': 0.9036}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[959   4  33   3   1]
 [  4 786  33 176   1]
 [ 13  18 924  38   7]
 [  2  81  66 850   1]
 [  0   0   1   0 999]]

##########
Iteration: 18
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_35gawj_c results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_18.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 293.3800196647644
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.31430411338806
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 13.800175189971924
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 7.619047619047614, 'template_1_label_0': 10.703363914373087, 'template_7_label_1': 0.0, 'template_2_label_1': 2.7624309392265234, 'template_3_label_0': 12.037037037037035, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.618593692779541
Performing exploitation...
Component: exploitation, run time: 5.567206859588623
Running testing for iteration: 18...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.903
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 18 test accuracy:
	End-to-end: 0.8544303797468354
	Network(s): {'digit': 0.903}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[967   2  27   3   1]
 [  6 781  36 176   1]
 [ 20  15 930  34   1]
 [  1  82  74 840   3]
 [  0   1   2   0 997]]

##########
Iteration: 19
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_s2l4qut7 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_19.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 270.2112350463867
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 30.447452545166016
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 14.30653715133667
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 11.428571428571432, 'template_1_label_0': 11.314984709480125, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 12.962962962962965, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.050657510757446
Performing exploitation...
Component: exploitation, run time: 5.31008505821228
Running testing for iteration: 19...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9026
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 19 test accuracy:
	End-to-end: 0.879746835443038
	Network(s): {'digit': 0.9026}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 955    4   36    3    2]
 [   4  798   31  167    0]
 [   9   24  922   41    4]
 [   2   98   60  838    2]
 [   0    0    0    0 1000]]

##########
Iteration: 20
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_5b2ys321 results/repeats/HS_fashion_mnist/100/2/pylasp/iteration_20.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 287.7214159965515
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 31.571271657943726
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 13.953304290771484
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.6666666666666616, 'template_2_label_0': 11.428571428571432, 'template_1_label_0': 9.785932721712543, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 11.111111111111116, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.464283466339111
Performing exploitation...
Component: exploitation, run time: 5.731395244598389
Running testing for iteration: 20...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8994
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 20 test accuracy:
	End-to-end: 0.8765822784810127
	Network(s): {'digit': 0.8994}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 961    4   30    4    1]
 [   3  798   29  170    0]
 [   8   19  922   44    7]
 [   3  107   71  816    3]
 [   0    0    0    0 1000]]
