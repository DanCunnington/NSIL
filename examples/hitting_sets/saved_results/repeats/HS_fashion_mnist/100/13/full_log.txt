########################################################
Neural-Symbolic Inductive Learner (NSIL)
########################################################
Current machine date/time: 2023-01-07 03:46:56.984876
Running on device: cuda:0
Saving log and results to: results/repeats/HS_fashion_mnist/100/13
Arguments: {'pct': 100, 'num_workers': 2, 'tune': False, 'logging': 'INFO', 'seed': 5724, 'num_iterations': 20, 'num_tuning_iterations': 2, 'explore_ex_lr': 1, 'exploit_ex_lr': 1, 'save_dir': 'results/repeats/HS_fashion_mnist/100/13', 'skip_initial_testing': False, 'custom_eval_interval': 1, 'nesy_reasoner': 'NeurASP', 'lr': 0.001, 'net_batch_size': 64, 'num_net_epochs': 1, 'save_nets': True, 'ilp_system': 'ILASP', 'custom_ilp_cmd_line_args': None, 'prune_ilp_example_weight_threshold': 1, 'use_bootstrap_cache': False, 'pylasp': True, 'ilp_config': None, 'task_type': 'hs', 'image_type': 'fashion_mnist'}
Loading data...
Starting NSIL training loop...

##########
Iteration: 1
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_sdg126dk results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_1.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Component: ILP, run time: 527.5681059360504
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Running testing for iteration: 0...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.1232
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 0 test accuracy:
	End-to-end: 0.569620253164557
	Network(s): {'digit': 0.1232}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[  0  16   0   4 980]
 [  0  30   0 213 757]
 [  0  36   0  36 928]
 [  0  14   0 166 820]
 [  0 512   0  68 420]]
Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 26.390930891036987
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.920652866363525
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 86.66666666666667, 'template_2_label_0': 6.190476190476191, 'template_1_label_0': 7.9510703363914415, 'template_7_label_1': 0.0, 'template_2_label_1': 81.21546961325967, 'template_3_label_0': 8.333333333333337, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 81.81818181818181, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.15856671333313
Performing exploitation...
Component: exploitation, run time: 5.513077020645142
Running testing for iteration: 1...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.7184
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 1 test accuracy:
	End-to-end: 0.7943037974683544
	Network(s): {'digit': 0.7184}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[968   4  19   7   2]
 [494 320  49 136   1]
 [ 99  53 741 100   7]
 [260 117  53 565   5]
 [  1   0   0   1 998]]

##########
Iteration: 2
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_k43l4yrm results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_2.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 264.46474838256836
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.46962118148804
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.620633125305176
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 7.333333333333336, 'template_2_label_0': 24.761904761904763, 'template_1_label_0': 29.357798165137616, 'template_7_label_1': 0.0, 'template_2_label_1': 7.182320441988955, 'template_3_label_0': 25.0, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 21.212121212121215, 'template_0_label_0': 1.8867924528301883}
Component: exploration, run time: 11.965611934661865
Performing exploitation...
Component: exploitation, run time: 5.489848375320435
Running testing for iteration: 2...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8562
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 2 test accuracy:
	End-to-end: 0.8449367088607594
	Network(s): {'digit': 0.8562}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[923   5  70   2   0]
 [  0 798  75 127   0]
 [ 10  17 964   9   0]
 [  4 239 156 601   0]
 [  0   1   4   0 995]]

##########
Iteration: 3
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_88i866xh results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_3.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 277.1094751358032
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.45788216590881
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.089845418930054
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.666666666666665, 'template_2_label_0': 22.38095238095238, 'template_1_label_0': 28.44036697247706, 'template_7_label_1': 0.0, 'template_2_label_1': 8.287292817679559, 'template_3_label_0': 24.07407407407407, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 2.8301886792452824}
Component: exploration, run time: 12.435723304748535
Performing exploitation...
Component: exploitation, run time: 5.9524757862091064
Running testing for iteration: 3...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8758
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 3 test accuracy:
	End-to-end: 0.8512658227848101
	Network(s): {'digit': 0.8758}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[898   4  94   4   0]
 [  0 742  63 195   0]
 [  3  14 965  17   1]
 [  1 107 116 776   0]
 [  0   0   2   0 998]]

##########
Iteration: 4
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_nssr0a96 results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_4.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 295.624662399292
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.41844320297241
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.058537006378174
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.000000000000005, 'template_2_label_0': 19.047619047619047, 'template_1_label_0': 24.15902140672783, 'template_7_label_1': 0.0, 'template_2_label_1': 8.83977900552486, 'template_3_label_0': 23.148148148148152, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 21.212121212121215, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 11.723339796066284
Performing exploitation...
Component: exploitation, run time: 5.823758363723755
Running testing for iteration: 4...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8886
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 4 test accuracy:
	End-to-end: 0.8734177215189873
	Network(s): {'digit': 0.8886}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[926   5  66   3   0]
 [  0 749  43 207   1]
 [  6  15 951  27   1]
 [  1  84  95 820   0]
 [  0   1   2   0 997]]

##########
Iteration: 5
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_15w21ks0 results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_5.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 300.9823098182678
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.3344886302948
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.896947622299194
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 6.000000000000005, 'template_2_label_0': 16.666666666666664, 'template_1_label_0': 23.853211009174313, 'template_7_label_1': 0.0, 'template_2_label_1': 7.734806629834257, 'template_3_label_0': 23.148148148148152, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.586186408996582
Performing exploitation...
Component: exploitation, run time: 5.788065671920776
Running testing for iteration: 5...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8954
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 5 test accuracy:
	End-to-end: 0.8829113924050633
	Network(s): {'digit': 0.8954}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[939   4  53   2   2]
 [  1 759  35 204   1]
 [  5  16 944  33   2]
 [  0  81  81 838   0]
 [  0   1   2   0 997]]

##########
Iteration: 6
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_iwntdlix results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_6.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 324.5005087852478
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.432776927948
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.317017078399658
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 15.714285714285714, 'template_1_label_0': 18.34862385321101, 'template_7_label_1': 0.0, 'template_2_label_1': 4.41988950276243, 'template_3_label_0': 19.444444444444443, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.22673511505127
Performing exploitation...
Component: exploitation, run time: 5.864488363265991
Running testing for iteration: 6...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9016
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 6 test accuracy:
	End-to-end: 0.879746835443038
	Network(s): {'digit': 0.9016}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[954   4  37   3   2]
 [  0 792  24 183   1]
 [ 14  23 923  39   1]
 [  1  91  67 841   0]
 [  0   1   1   0 998]]

##########
Iteration: 7
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_un86__vn results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_7.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 353.8892719745636
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.31741261482239
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.984012842178345
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.666666666666663, 'template_2_label_0': 14.28571428571429, 'template_1_label_0': 15.596330275229352, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 20.370370370370374, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.194251775741577
Performing exploitation...
Component: exploitation, run time: 5.682619094848633
Running testing for iteration: 7...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9016
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 7 test accuracy:
	End-to-end: 0.8860759493670886
	Network(s): {'digit': 0.9016}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[947   5  40   6   2]
 [  1 815  23 159   2]
 [ 11  31 917  38   3]
 [  0 107  59 832   2]
 [  0   1   2   0 997]]

##########
Iteration: 8
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_qbd7xb6v results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_8.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 318.5573818683624
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.9533212184906
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.832921504974365
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 15.238095238095239, 'template_1_label_0': 16.207951070336392, 'template_7_label_1': 0.0, 'template_2_label_1': 7.734806629834257, 'template_3_label_0': 19.444444444444443, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 18.181818181818176, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 12.302158117294312
Performing exploitation...
Component: exploitation, run time: 5.477008104324341
Running testing for iteration: 8...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9012
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 8 test accuracy:
	End-to-end: 0.8924050632911392
	Network(s): {'digit': 0.9012}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[946   3  42   7   2]
 [  0 820  19 157   4]
 [  5  34 901  54   6]
 [  0 105  53 840   2]
 [  0   0   1   0 999]]

##########
Iteration: 9
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_a8iesbxh results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_9.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 241.82305097579956
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.40542531013489
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.918576955795288
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 11.904761904761907, 'template_1_label_0': 13.455657492354744, 'template_7_label_1': 0.0, 'template_2_label_1': 8.287292817679559, 'template_3_label_0': 17.59259259259259, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 15.151515151515149, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.042542695999146
Performing exploitation...
Component: exploitation, run time: 5.807931184768677
Running testing for iteration: 9...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9018
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 9 test accuracy:
	End-to-end: 0.9050632911392406
	Network(s): {'digit': 0.9018}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[959   3  32   6   0]
 [  0 826  23 149   2]
 [ 16  36 903  43   2]
 [  1 126  48 823   2]
 [  0   2   0   0 998]]

##########
Iteration: 10
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_m9uaj3y7 results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_10.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 312.9516055583954
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.35317611694336
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.910334825515747
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.6666666666666616, 'template_2_label_0': 10.476190476190473, 'template_1_label_0': 11.926605504587151, 'template_7_label_1': 0.0, 'template_2_label_1': 6.629834254143652, 'template_3_label_0': 14.814814814814813, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.9433962264150941}
Component: exploration, run time: 11.417297840118408
Performing exploitation...
Component: exploitation, run time: 5.819813966751099
Running testing for iteration: 10...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9016
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 10 test accuracy:
	End-to-end: 0.9018987341772152
	Network(s): {'digit': 0.9016}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 968    4   21    7    0]
 [   1  830   18  149    2]
 [  23   33  881   58    5]
 [   2  122   46  829    1]
 [   0    0    0    0 1000]]

##########
Iteration: 11
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_7jrio9l_ results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_11.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 329.4425117969513
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.61504578590393
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.024921655654907
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.6666666666666616, 'template_2_label_0': 9.999999999999998, 'template_1_label_0': 10.703363914373087, 'template_7_label_1': 0.0, 'template_2_label_1': 4.41988950276243, 'template_3_label_0': 16.666666666666664, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.717065572738647
Performing exploitation...
Component: exploitation, run time: 5.642318248748779
Running testing for iteration: 11...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.903
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 11 test accuracy:
	End-to-end: 0.8987341772151899
	Network(s): {'digit': 0.903}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 973    3   18    6    0]
 [   2  812   19  164    3]
 [  29   31  874   59    7]
 [   2   99   42  856    1]
 [   0    0    0    0 1000]]

##########
Iteration: 12
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_9kpdbvig results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_12.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 295.08524203300476
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.365583658218384
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.38692045211792
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 10.952380952380958, 'template_1_label_0': 11.009174311926607, 'template_7_label_1': 0.0, 'template_2_label_1': 3.8674033149171283, 'template_3_label_0': 12.962962962962965, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.228500366210938
Performing exploitation...
Component: exploitation, run time: 5.872601509094238
Running testing for iteration: 12...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9016
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 12 test accuracy:
	End-to-end: 0.9018987341772152
	Network(s): {'digit': 0.9016}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 970    5   19    5    1]
 [   2  844   23  128    3]
 [  33   28  872   57   10]
 [   2  123   50  822    3]
 [   0    0    0    0 1000]]

##########
Iteration: 13
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_1p0b12jx results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_13.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 269.90407705307007
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.29947566986084
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.010313987731934
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 9.999999999999998, 'template_1_label_0': 11.620795107033643, 'template_7_label_1': 0.0, 'template_2_label_1': 4.972375690607733, 'template_3_label_0': 14.814814814814813, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.409862279891968
Performing exploitation...
Component: exploitation, run time: 6.139804840087891
Running testing for iteration: 13...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8996
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 13 test accuracy:
	End-to-end: 0.8924050632911392
	Network(s): {'digit': 0.8996}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 967    3   24    4    2]
 [   1  849   15  129    6]
 [  21   43  873   56    7]
 [   4  134   45  809    8]
 [   0    0    0    0 1000]]

##########
Iteration: 14
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_d50e10ta results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_14.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 354.1596541404724
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.25451397895813
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.982527494430542
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 12.857142857142856, 'template_1_label_0': 12.538226299694188, 'template_7_label_1': 0.0, 'template_2_label_1': 3.8674033149171283, 'template_3_label_0': 11.111111111111116, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.782469987869263
Performing exploitation...
Component: exploitation, run time: 5.86570930480957
Running testing for iteration: 14...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8976
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 14 test accuracy:
	End-to-end: 0.8829113924050633
	Network(s): {'digit': 0.8976}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[976   3  18   3   0]
 [  4 869  17 107   3]
 [ 44  38 882  32   4]
 [  6 162  65 763   4]
 [  1   1   0   0 998]]

##########
Iteration: 15
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_03_niaib results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_15.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 282.4017496109009
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.2600793838501
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.484419584274292
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 7.619047619047614, 'template_1_label_0': 10.09174311926605, 'template_7_label_1': 0.0, 'template_2_label_1': 2.7624309392265234, 'template_3_label_0': 10.185185185185187, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.119281530380249
Performing exploitation...
Component: exploitation, run time: 5.853865623474121
Running testing for iteration: 15...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9008
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 15 test accuracy:
	End-to-end: 0.9050632911392406
	Network(s): {'digit': 0.9008}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[964   7  25   4   0]
 [  1 854  20 122   3]
 [ 22  36 896  42   4]
 [  2 148  56 791   3]
 [  0   1   0   0 999]]

##########
Iteration: 16
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_guunznnh results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_16.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 301.1346218585968
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.0919554233551
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.024248123168945
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 8.0952380952381, 'template_1_label_0': 10.397553516819569, 'template_7_label_1': 0.0, 'template_2_label_1': 4.41988950276243, 'template_3_label_0': 8.333333333333337, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.641384363174438
Performing exploitation...
Component: exploitation, run time: 6.3419599533081055
Running testing for iteration: 16...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9022
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 16 test accuracy:
	End-to-end: 0.8860759493670886
	Network(s): {'digit': 0.9022}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 969    6   19    6    0]
 [   2  866   24  105    3]
 [  21   29  895   45   10]
 [   2  148   63  781    6]
 [   0    0    0    0 1000]]

##########
Iteration: 17
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_4sfux_x4 results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_17.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 323.083945274353
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.54854917526245
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.718623638153076
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.0000000000000036, 'template_2_label_0': 8.0952380952381, 'template_1_label_0': 11.926605504587151, 'template_7_label_1': 0.0, 'template_2_label_1': 6.077348066298338, 'template_3_label_0': 16.666666666666664, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 6.060606060606055, 'template_0_label_0': 0.0}
Component: exploration, run time: 11.900476455688477
Performing exploitation...
Component: exploitation, run time: 5.893311500549316
Running testing for iteration: 17...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8988
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 17 test accuracy:
	End-to-end: 0.8829113924050633
	Network(s): {'digit': 0.8988}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 935    6   51    8    0]
 [   0  838   18  142    2]
 [   3   45  893   56    3]
 [   1  122   46  828    3]
 [   0    0    0    0 1000]]

##########
Iteration: 18
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_nei3maw7 results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_18.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 244.08334255218506
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.11630582809448
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 15.558246850967407
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 3.3333333333333326, 'template_2_label_0': 7.619047619047614, 'template_1_label_0': 11.009174311926607, 'template_7_label_1': 0.0, 'template_2_label_1': 3.314917127071826, 'template_3_label_0': 12.962962962962965, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 13.05330514907837
Performing exploitation...
Component: exploitation, run time: 6.403135061264038
Running testing for iteration: 18...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9046
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 18 test accuracy:
	End-to-end: 0.8892405063291139
	Network(s): {'digit': 0.9046}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 955    5   32    7    1]
 [   0  820   20  157    3]
 [   5   24  912   52    7]
 [   2  107   52  836    3]
 [   0    0    0    0 1000]]

##########
Iteration: 19
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_p9qxd7s0 results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_19.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 300.69581723213196
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.13055634498596
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.13450288772583
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 6.190476190476191, 'template_1_label_0': 7.645259938837922, 'template_7_label_1': 0.0, 'template_2_label_1': 3.8674033149171283, 'template_3_label_0': 12.037037037037035, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 9.090909090909093, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.112226247787476
Performing exploitation...
Component: exploitation, run time: 5.810118913650513
Running testing for iteration: 19...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.8986
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 19 test accuracy:
	End-to-end: 0.8955696202531646
	Network(s): {'digit': 0.8986}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 969    4   19    8    0]
 [   1  818   20  157    4]
 [  28   33  862   69    8]
 [   2  111   41  844    2]
 [   0    0    0    0 1000]]

##########
Iteration: 20
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_ezgvmccw results/repeats/HS_fashion_mnist/100/13/pylasp/iteration_20.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 284.4972116947174
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 33.663769245147705
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 16.079577445983887
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.0000000000000018, 'template_2_label_0': 6.666666666666665, 'template_1_label_0': 9.174311926605505, 'template_7_label_1': 0.0, 'template_2_label_1': 2.209944751381221, 'template_3_label_0': 7.4074074074074066, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 12.121212121212121, 'template_0_label_0': 0.0}
Component: exploration, run time: 12.032485246658325
Performing exploitation...
Component: exploitation, run time: 6.353841304779053
Running testing for iteration: 20...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9016
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 20 test accuracy:
	End-to-end: 0.8955696202531646
	Network(s): {'digit': 0.9016}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 964    6   26    4    0]
 [   3  840   20  135    2]
 [  16   28  890   58    8]
 [   2  128   52  814    4]
 [   0    0    0    0 1000]]
