########################################################
Neural-Symbolic Inductive Learner (NSIL)
########################################################
Current machine date/time: 2022-09-18 18:20:39.974911
Running on device: cuda:0
Saving log and results to: results/varying_lambda/HS_mnist/40/0.2/5
Arguments: {'pct': 40, 'num_workers': 2, 'tune': False, 'logging': 'INFO', 'seed': 5657, 'num_iterations': 10, 'num_tuning_iterations': 2, 'explore_ex_lr': 1, 'exploit_ex_lr': 0.2, 'save_dir': 'results/varying_lambda/HS_mnist/40/0.2/5', 'skip_initial_testing': False, 'custom_eval_interval': 1, 'nesy_reasoner': 'NeurASP', 'lr': 0.001, 'net_batch_size': 64, 'num_net_epochs': 1, 'ilp_system': 'ILASP', 'custom_ilp_cmd_line_args': None, 'prune_ilp_example_weight_threshold': 1, 'use_bootstrap_cache': False, 'pylasp': True, 'ilp_config': None, 'task_type': 'hs', 'image_type': 'mnist'}
Loading data...
Starting NSIL training loop...

##########
Iteration: 1
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_668rzehn results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_1.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Component: ILP, run time: 280.49401211738586
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(3,V2); ss_element(V1,1); elt(V2); ss(V1).
hit(V1) :- ss_element(V1,V2); not hit(V3); ss(V3); elt(V2); ss(V1).

Running testing for iteration: 0...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.2062957830132647
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 0 test accuracy:
	End-to-end: 0.5727848101265823
	Network(s): {'digit': 0.2062957830132647}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[  0   0 862   0 273]
 [  0   0 281   0 751]
 [  3   0 478   0 529]
 [  0   0 102   0 880]
 [  0   0 328   0 564]]
Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 9.291056156158447
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 17.67407727241516
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 61.9718309859155, 'template_2_label_0': 16.279069767441857, 'template_1_label_0': 17.391304347826086, 'template_7_label_1': 0.0, 'template_2_label_1': 66.17647058823529, 'template_3_label_0': 25.71428571428571, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 66.66666666666667, 'template_0_label_0': 0.0}
Component: exploration, run time: 6.8683226108551025
Performing exploitation...
Component: exploitation, run time: 3.352734327316284
Running testing for iteration: 1...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.7448030093050881
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 1 test accuracy:
	End-to-end: 0.7753164556962026
	Network(s): {'digit': 0.7448030093050881}
	Hypothesis: 0.7943037974683544
Confusion matrix for network digit:
[[1127    4    2    0    2]
 [  88  540  380    5   19]
 [  24   14  667   16  289]
 [  22    2   33  566  359]
 [  24    2    4    0  862]]

##########
Iteration: 2
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_bakw0b2_ results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_2.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
hit(V1) :- ss_element(V1,1); ss(V1).
hit(V1) :- ss_element(V1,V2); ss_element(3,V2); elt(V2); ss(V1).
 :- ss_element(V1,V2); ss_element(3,V3); not hit(V1); elt(V3); elt(V2); ss(V1).

Component: ILP, run time: 240.34617495536804
Converted hypothesis for neural-symbolic reasoning:
hit(V1) :- ss_element(V1,1); ss(V1).
hit(V1) :- ss_element(V1,V2); ss_element(3,V2); elt(V2); ss(V1).
 :- ss_element(V1,V2); ss_element(3,V3); not hit(V1); elt(V3); elt(V2); ss(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 8.782248973846436
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 17.92035174369812
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 66.19718309859155, 'template_2_label_0': 5.813953488372093, 'template_1_label_0': 2.1739130434782594, 'template_7_label_1': 0.0, 'template_2_label_1': 38.23529411764706, 'template_3_label_0': 11.428571428571432, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 25.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 7.383277893066406
Performing exploitation...
Component: exploitation, run time: 3.4281718730926514
Running testing for iteration: 2...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9576321520490992
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 2 test accuracy:
	End-to-end: 0.870253164556962
	Network(s): {'digit': 0.9576321520490992}
	Hypothesis: 0.8765822784810127
Confusion matrix for network digit:
[[1131    2    2    0    0]
 [  35  958   25   12    2]
 [   4   20  941   13   32]
 [   9    2    2  969    0]
 [   8    0   11   35  838]]

##########
Iteration: 3
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_jnrwge7l results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_3.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 143.4974763393402
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 12.08980393409729
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 22.443098545074463
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.8169014084507005, 'template_2_label_0': 4.651162790697672, 'template_1_label_0': 7.971014492753625, 'template_7_label_1': 0.0, 'template_2_label_1': 4.411764705882348, 'template_3_label_0': 17.14285714285714, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 8.047128438949585
Performing exploitation...
Component: exploitation, run time: 3.4314260482788086
Running testing for iteration: 3...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9693130073252821
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 3 test accuracy:
	End-to-end: 0.9715189873417721
	Network(s): {'digit': 0.9693130073252821}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1130    1    3    1    0]
 [  12  997   10   10    3]
 [   1   15  918    8   68]
 [   5    2    2  967    6]
 [   2    0    4    2  884]]

##########
Iteration: 4
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_xs3pwxxj results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_4.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 147.30265045166016
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.697425365447998
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.11220645904541
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.225352112676061, 'template_2_label_0': 5.813953488372093, 'template_1_label_0': 12.318840579710145, 'template_7_label_1': 0.0, 'template_2_label_1': 2.941176470588236, 'template_3_label_0': 5.714285714285716, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 8.333333333333337, 'template_0_label_0': 0.0}
Component: exploration, run time: 7.232056140899658
Performing exploitation...
Component: exploitation, run time: 3.5636191368103027
Running testing for iteration: 4...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9602058998218175
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 4 test accuracy:
	End-to-end: 0.9715189873417721
	Network(s): {'digit': 0.9602058998218175}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1131    3    1    0    0]
 [   3 1018    0    9    2]
 [   2   30  841    4  133]
 [   7    1    0  970    4]
 [   1    0    0    1  890]]

##########
Iteration: 5
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_phbd1ist results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_5.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 151.78707814216614
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.734735250473022
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 22.05206823348999
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.8169014084507005, 'template_2_label_0': 5.813953488372093, 'template_1_label_0': 7.971014492753625, 'template_7_label_1': 0.0, 'template_2_label_1': 2.941176470588236, 'template_3_label_0': 2.857142857142858, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 7.4819488525390625
Performing exploitation...
Component: exploitation, run time: 3.3077335357666016
Running testing for iteration: 5...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9699069491189863
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 5 test accuracy:
	End-to-end: 0.9810126582278481
	Network(s): {'digit': 0.9699069491189863}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1132    2    1    0    0]
 [  12  984    0   35    1]
 [   0   14  927    8   61]
 [   4    0    0  975    3]
 [   2    0    0    9  881]]

##########
Iteration: 6
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_l5c86aik results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_6.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 154.79397058486938
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.63137435913086
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.021750450134277
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 1.4084507042253502, 'template_2_label_0': 2.3255813953488413, 'template_1_label_0': 2.1739130434782594, 'template_7_label_1': 0.0, 'template_2_label_1': 0.0, 'template_3_label_0': 5.714285714285716, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 6.956344842910767
Performing exploitation...
Component: exploitation, run time: 3.321924924850464
Running testing for iteration: 6...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9732726192833102
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 6 test accuracy:
	End-to-end: 0.9873417721518988
	Network(s): {'digit': 0.9732726192833102}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1130    4    1    0    0]
 [   3 1026    0    3    0]
 [   2   35  935    2   36]
 [  24    4    1  947    6]
 [   4    2    6    2  878]]

##########
Iteration: 7
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_8dwh9gio results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_7.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 153.6714928150177
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.593437194824219
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.409403562545776
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 4.225352112676061, 'template_2_label_0': 1.1627906976744207, 'template_1_label_0': 0.7246376811594235, 'template_7_label_1': 0.0, 'template_2_label_1': 0.0, 'template_3_label_0': 2.857142857142858, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 7.036540746688843
Performing exploitation...
Component: exploitation, run time: 3.640204906463623
Running testing for iteration: 7...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9803999208077608
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 7 test accuracy:
	End-to-end: 0.990506329113924
	Network(s): {'digit': 0.9803999208077608}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1128    4    1    0    2]
 [   3 1021    0    7    1]
 [   3   20  960    7   20]
 [   9    3    0  967    3]
 [   0    1   10    5  876]]

##########
Iteration: 8
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_scypzpko results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_8.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 141.28231978416443
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.698121309280396
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.260303020477295
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.8169014084507005, 'template_2_label_0': 1.1627906976744207, 'template_1_label_0': 0.7246376811594235, 'template_7_label_1': 0.0, 'template_2_label_1': 0.0, 'template_3_label_0': 2.857142857142858, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 6.919692039489746
Performing exploitation...
Component: exploitation, run time: 3.577287197113037
Running testing for iteration: 8...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9877252029301129
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 8 test accuracy:
	End-to-end: 0.9968354430379747
	Network(s): {'digit': 0.9877252029301129}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1132    2    1    0    0]
 [   6 1013    4    7    2]
 [   0    6  990    6    8]
 [   2    2    1  977    0]
 [   2    0    9    4  877]]

##########
Iteration: 9
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_8zcupo_7 results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_9.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 147.31710982322693
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.757261514663696
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 18.05186676979065
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 0.0, 'template_2_label_0': 0.0, 'template_1_label_0': 1.449275362318836, 'template_7_label_1': 0.0, 'template_2_label_1': 0.0, 'template_3_label_0': 2.857142857142858, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 7.333092212677002
Performing exploitation...
Component: exploitation, run time: 3.3331398963928223
Running testing for iteration: 9...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9855474163531974
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 9 test accuracy:
	End-to-end: 0.9936708860759493
	Network(s): {'digit': 0.9855474163531974}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1127    3    3    0    2]
 [   3 1018    4    4    3]
 [   0    7  980    2   21]
 [   3    4    2  965    8]
 [   0    0    4    0  888]]

##########
Iteration: 10
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/ILASP /tmp/NSIL_tmp_file_f2poxmkd results/varying_lambda/HS_mnist/40/0.2/5/pylasp/iteration_10.las --strict-types --restarts --max-rule-length=3 --quiet
Learned hypothesis:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Component: ILP, run time: 150.91966843605042
Converted hypothesis for neural-symbolic reasoning:
 :- ss_element(V1,V2); not hit(V1); elt(V2); ss(V1).
0 {hs(V1,V2) } 1 :- elt(V2); hs_index(V1).
hit(V1) :- hs(V3,V2); ss_element(V1,V2); hs_index(V3); elt(V2); ss(V1).
 :- hs(V3,V1); hs(V3,V2); V1 != V2; hs_index(V3); elt(V2); elt(V1).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 11.990208625793457
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 22.158002853393555
Performing exploration... 
False Negative Rate for each label/structure combination:
{'template_5_label_1': 0.0, 'template_1_label_1': 2.8169014084507005, 'template_2_label_0': 0.0, 'template_1_label_0': 0.0, 'template_7_label_1': 0.0, 'template_2_label_1': 0.0, 'template_3_label_0': 2.857142857142858, 'template_4_label_1': 0.0, 'template_6_label_1': 0.0, 'template_3_label_1': 0.0, 'template_0_label_0': 0.0}
Component: exploration, run time: 8.367709159851074
Performing exploitation...
Component: exploitation, run time: 3.8382339477539062
Running testing for iteration: 10...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9829736685804791
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 10 test accuracy:
	End-to-end: 0.9936708860759493
	Network(s): {'digit': 0.9829736685804791}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[1132    2    1    0    0]
 [   8 1017    1    5    1]
 [   0   11  992    3    4]
 [  12    3    2  962    3]
 [   4    1   10   15  862]]
