########################################################
Neural-Symbolic Inductive Learner (NSIL)
########################################################
Current machine date/time: 2023-01-06 04:24:38.007201
Running on device: cuda:0
Saving log and results to: results/repeats/sum/100/5
Arguments: {'pct': 100, 'num_workers': 2, 'tune': False, 'logging': 'INFO', 'seed': 5657, 'num_iterations': 20, 'num_tuning_iterations': 2, 'explore_ex_lr': 1, 'exploit_ex_lr': 1, 'save_dir': 'results/repeats/sum/100/5', 'skip_initial_testing': False, 'custom_eval_interval': 1, 'nesy_reasoner': 'NeurASP', 'lr': 0.001, 'net_batch_size': 64, 'num_net_epochs': 1, 'save_nets': True, 'ilp_system': 'FastLAS', 'custom_ilp_cmd_line_args': None, 'prune_ilp_example_weight_threshold': 1, 'use_bootstrap_cache': False, 'pylasp': False, 'ilp_config': None, 'task_type': 'sum', 'image_type': 'mnist'}
Loading data...
Starting NSIL training loop...

##########
Iteration: 1
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_8cdr7wbp --solver="ASP" --fl2 --threads 128 --write-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 13.746108293533325
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Running testing for iteration: 0...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.0816
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 0 test accuracy:
	End-to-end: 0.0936
	Network(s): {'digit': 0.0816}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[   2    0    0  270    0  694    0   14    0    0]
 [   0    0    0   17    0 1117    0    1    0    0]
 [   0    0    0  100    0  804    0  128    0    0]
 [   0    0    0  160    0  767    0   83    0    0]
 [   1    0    0   49    0  884    0   48    0    0]
 [   0    0    0  127    0  654    0  111    0    0]
 [   5    0    0  450    0  464    0   39    0    0]
 [   0    0    0   13    0 1015    0    0    0    0]
 [   0    0    0  108    0  712    0  154    0    0]
 [   0    0    0   27    0  900    0   82    0    0]]
Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 83.40024876594543
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.21984815597534
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 2.48565965583174, 'label_5': 2.586793737236215, 'label_15': 6.314699792960665, 'label_8': 3.443526170798894, 'label_6': 4.009433962264152, 'label_9': 4.3496445002091155, 'label_13': 5.066854327938075, 'label_7': 3.168635875402792, 'label_10': 4.126101066295784, 'label_11': 4.606320299946443, 'label_12': 4.073838319541689, 'label_14': 5.4195804195804165, 'label_4': 2.395740905057675, 'label_3': 3.5781544256120568, 'label_2': 3.86007237635706, 'label_16': 5.111402359108785, 'label_17': 5.919661733615222, 'label_0': 3.2258064516129004, 'label_18': 6.719367588932801}
Component: exploration, run time: 57.38334012031555
Performing exploitation...
Component: exploitation, run time: 30.8909649848938
Running testing for iteration: 1...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9775
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 1 test accuracy:
	End-to-end: 0.9554
	Network(s): {'digit': 0.9775}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 966    2    1    0    1    1    0    1    3    5]
 [   0 1129    0    4    0    0    1    0    1    0]
 [   5    5 1010    3    0    0    1    6    2    0]
 [   0    0    3  994    0    5    0    4    3    1]
 [   0    0    3    0  967    0    3    2    1    6]
 [   1    0    0    7    0  878    2    1    2    1]
 [   9    3    1    1   12    6  924    0    2    0]
 [   1    5   16    2    1    0    0  996    1    6]
 [   1    0    3   13    4    1    2    4  935   11]
 [   2    3    0    3    8    7    0    8    2  976]]

##########
Iteration: 2
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_9dqgmlag --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 89.28660845756531
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 82.76339817047119
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.99884057044983
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 1.5296367112810683, 'label_5': 1.1572498298161982, 'label_15': 3.6231884057971064, 'label_8': 2.203856749311295, 'label_6': 2.594339622641506, 'label_9': 3.8895859473023875, 'label_13': 3.659394792399717, 'label_7': 1.5574650912996812, 'label_10': 3.2916087158089913, 'label_11': 2.517407605784683, 'label_12': 2.9280712921705865, 'label_14': 3.1468531468531458, 'label_4': 1.3309671694764824, 'label_3': 2.4482109227871973, 'label_2': 2.6537997587454787, 'label_16': 2.6212319790301475, 'label_17': 4.651162790697672, 'label_0': 2.0161290322580627, 'label_18': 5.533596837944666}
Component: exploration, run time: 56.8121874332428
Performing exploitation...
Component: exploitation, run time: 29.531550407409668
Running testing for iteration: 2...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9834
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 2 test accuracy:
	End-to-end: 0.9668
	Network(s): {'digit': 0.9834}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 974    2    1    0    1    0    0    1    1    0]
 [   0 1127    1    3    0    0    1    1    2    0]
 [   0    3 1024    0    0    0    1    2    2    0]
 [   0    0    5 1000    0    2    0    1    2    0]
 [   0    0    3    0  974    0    0    1    0    4]
 [   2    0    0   14    0  871    2    1    2    0]
 [   8    3    2    2    7    5  931    0    0    0]
 [   0    3   11    3    0    0    0 1005    1    5]
 [   1    0    8    9    3    2    0    4  940    7]
 [   2    0    0    3    6    2    0    7    1  988]]

##########
Iteration: 3
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_5nhaxfoz --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 100.45689654350281
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 84.98935604095459
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.193042516708374
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.7648183556405397, 'label_5': 1.1572498298161982, 'label_15': 3.8302277432712195, 'label_8': 1.9283746556473802, 'label_6': 2.2995283018867885, 'label_9': 2.634880803011297, 'label_13': 3.2371569317382165, 'label_7': 1.235230934479059, 'label_10': 2.318034306907746, 'label_11': 2.463845741831816, 'label_12': 2.2278803309993656, 'label_14': 2.8846153846153855, 'label_4': 0.9760425909494219, 'label_3': 1.883239171374762, 'label_2': 1.0856453558504175, 'label_16': 1.7038007863695914, 'label_17': 4.228329809725162, 'label_0': 1.2096774193548376, 'label_18': 3.9525691699604737}
Component: exploration, run time: 57.39303159713745
Performing exploitation...
Component: exploitation, run time: 29.132890462875366
Running testing for iteration: 3...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9849
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 3 test accuracy:
	End-to-end: 0.9698
	Network(s): {'digit': 0.9849}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 974    2    1    0    0    1    0    1    1    0]
 [   0 1129    0    4    0    0    1    1    0    0]
 [   1    3 1019    2    0    0    2    3    2    0]
 [   0    0    3 1006    0    0    0    0    1    0]
 [   0    0    2    0  976    0    0    0    0    4]
 [   2    0    0   15    0  872    1    0    1    1]
 [   6    2    0    3    5    4  936    0    2    0]
 [   0    3    9    2    0    0    0 1009    1    4]
 [   1    0    7   16    2    2    0    3  938    5]
 [   0    1    0    3    4    1    1    6    3  990]]

##########
Iteration: 4
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_stt7aas8 --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 103.42090201377869
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 81.75546646118164
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.53316068649292
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.7648183556405397, 'label_5': 0.6807351940095296, 'label_15': 2.5879917184264967, 'label_8': 1.423324150596883, 'label_6': 1.5919811320754707, 'label_9': 2.1329987452948562, 'label_13': 2.463054187192115, 'label_7': 0.8592910848549962, 'label_10': 1.9007881316643438, 'label_11': 1.3926084627745028, 'label_12': 1.5276893698281335, 'label_14': 1.7482517482517501, 'label_4': 0.709849157054121, 'label_3': 1.5065913370998163, 'label_2': 1.2062726176115812, 'label_16': 1.0484927916120546, 'label_17': 3.594080338266381, 'label_0': 1.6129032258064502, 'label_18': 3.5573122529644285}
Component: exploration, run time: 55.424851179122925
Performing exploitation...
Component: exploitation, run time: 29.516419887542725
Running testing for iteration: 4...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9853
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 4 test accuracy:
	End-to-end: 0.9708
	Network(s): {'digit': 0.9853}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 968    2    1    0    3    1    0    1    0    4]
 [   0 1128    0    5    0    0    1    1    0    0]
 [   1    3 1015    3    3    0    0    5    2    0]
 [   0    0    3 1004    0    2    0    0    1    0]
 [   0    0    2    0  973    0    0    0    0    7]
 [   2    0    0    7    0  881    1    0    0    1]
 [   6    3    0    3    9    4  932    0    1    0]
 [   0    2    3    2    0    0    0 1016    1    4]
 [   1    0    3   14    3    4    0    4  942    3]
 [   2    0    0    1    4    2    0    4    2  994]]

##########
Iteration: 5
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_iiejqkzn --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 114.94763970375061
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 84.57110714912415
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.433449268341064
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 1.147227533460804, 'label_5': 0.2722940776038074, 'label_15': 2.1739130434782594, 'label_8': 1.1937557392102893, 'label_6': 1.2382075471698117, 'label_9': 1.7147636971978297, 'label_13': 2.1111893033075257, 'label_7': 0.8055853920515554, 'label_10': 1.3444598980064892, 'label_11': 0.8034279592929794, 'label_12': 1.400381922342453, 'label_14': 1.7482517482517501, 'label_4': 1.0647737355811926, 'label_3': 1.0357815442561202, 'label_2': 0.8443908323281013, 'label_16': 1.0484927916120546, 'label_17': 2.3255813953488413, 'label_0': 0.0, 'label_18': 1.5810276679841917}
Component: exploration, run time: 56.44729828834534
Performing exploitation...
Component: exploitation, run time: 29.869479417800903
Running testing for iteration: 5...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9873
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 5 test accuracy:
	End-to-end: 0.975
	Network(s): {'digit': 0.9873}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 971    2    2    0    2    1    0    1    0    1]
 [   0 1128    0    4    0    0    1    1    0    1]
 [   1    1 1019    2    1    0    2    5    1    0]
 [   0    0    5  998    0    3    0    1    2    1]
 [   0    0    1    0  972    0    2    0    0    7]
 [   2    0    0    5    0  883    1    0    0    1]
 [   6    2    0    0    3    3  944    0    0    0]
 [   0    2    6    1    0    0    0 1013    1    5]
 [   1    0    4    8    3    4    0    4  948    2]
 [   2    0    0    1    5    1    0    1    2  997]]

##########
Iteration: 6
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_vh0v0vsm --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 107.19313502311707
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 81.5479166507721
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.33542990684509
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.9560229445506718, 'label_5': 0.6807351940095296, 'label_15': 1.65631469979296, 'label_8': 0.9182736455463747, 'label_6': 0.8844339622641528, 'label_9': 1.2965286491007921, 'label_13': 1.407459535538358, 'label_7': 0.8055853920515554, 'label_10': 1.066295781177562, 'label_11': 0.8034279592929794, 'label_12': 0.9548058561425821, 'label_14': 0.8741258741258751, 'label_4': 0.4436557231588312, 'label_3': 0.6591337099811634, 'label_2': 0.4825090470446325, 'label_16': 0.2621231979030192, 'label_17': 2.3255813953488413, 'label_0': 0.40322580645161255, 'label_18': 1.1857707509881465}
Component: exploration, run time: 56.78849673271179
Performing exploitation...
Component: exploitation, run time: 30.483063220977783
Running testing for iteration: 6...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9888
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 6 test accuracy:
	End-to-end: 0.9778
	Network(s): {'digit': 0.9888}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 973    2    2    0    1    1    0    1    0    0]
 [   0 1130    1    1    0    0    1    2    0    0]
 [   1    2 1022    1    3    0    0    2    1    0]
 [   0    0    5  999    0    4    0    0    2    0]
 [   0    0    2    0  973    0    0    0    0    7]
 [   2    0    0    6    0  884    0    0    0    0]
 [   7    4    0    0    2    5  939    0    1    0]
 [   0    2    7    1    0    0    0 1013    1    4]
 [   1    0    3    5    2    3    0    0  958    2]
 [   1    0    0    0    4    2    0    4    1  997]]

##########
Iteration: 7
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_z20pe6tv --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 109.26290488243103
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 83.09098243713379
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.758601903915405
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.3824091778202643, 'label_5': 0.5445881552076259, 'label_15': 1.0351966873705987, 'label_8': 0.7805325987144118, 'label_6': 1.1792452830188704, 'label_9': 1.1710581346716875, 'label_13': 0.8444757213230125, 'label_7': 0.9129967776584369, 'label_10': 0.8344923504867818, 'label_11': 0.5891805034815234, 'label_12': 1.2094207511139432, 'label_14': 0.5244755244755206, 'label_4': 1.0647737355811926, 'label_3': 0.941619585687381, 'label_2': 0.6031363088057851, 'label_16': 0.5242463958060273, 'label_17': 1.2684989429175508, 'label_0': 0.0, 'label_18': 1.5810276679841917}
Component: exploration, run time: 57.08027648925781
Performing exploitation...
Component: exploitation, run time: 30.34660816192627
Running testing for iteration: 7...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9874
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 7 test accuracy:
	End-to-end: 0.975
	Network(s): {'digit': 0.9874}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 974    1    1    0    0    1    0    2    1    0]
 [   0 1129    2    1    0    0    1    1    0    1]
 [   1    1 1022    0    1    0    3    3    1    0]
 [   0    0    5  993    0    4    0    2    4    2]
 [   0    0    1    0  970    0    2    1    0    8]
 [   2    0    0    5    0  883    1    0    0    1]
 [   8    2    0    0    3    5  940    0    0    0]
 [   0    2    8    0    0    0    0 1014    1    3]
 [   1    0    4    4    2    5    0    1  956    1]
 [   2    0    0    0    3    3    0    4    4  993]]

##########
Iteration: 8
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_gmm93clo --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 120.79478025436401
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 84.43108248710632
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.42011833190918
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.5736137667303964, 'label_5': 0.4084411164057222, 'label_15': 1.9668737060041352, 'label_8': 0.9641873278236957, 'label_6': 1.0613207547169767, 'label_9': 1.2547051442910906, 'label_13': 1.688951442646025, 'label_7': 0.9667024704618665, 'label_10': 1.3908205841446475, 'label_11': 1.2854847348687692, 'label_12': 1.2094207511139432, 'label_14': 1.1363636363636354, 'label_4': 0.4436557231588312, 'label_3': 0.8474576271186418, 'label_2': 0.3618817852834688, 'label_16': 0.7863695937090465, 'label_17': 1.4799154334038, 'label_0': 0.8064516129032251, 'label_18': 0.7905138339920903}
Component: exploration, run time: 55.83818697929382
Performing exploitation...
Component: exploitation, run time: 28.46399188041687
Running testing for iteration: 8...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9879
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 8 test accuracy:
	End-to-end: 0.9758
	Network(s): {'digit': 0.9879}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 970    2    0    0    3    1    0    1    0    3]
 [   0 1129    2    2    0    0    1    1    0    0]
 [   1    1 1021    2    3    0    0    2    2    0]
 [   0    0    5 1002    0    3    0    0    0    0]
 [   0    0    0    0  975    0    0    0    0    7]
 [   2    0    0    6    0  884    0    0    0    0]
 [   7    3    0    0    6    6  935    0    1    0]
 [   0    2    5    2    0    0    0 1013    1    5]
 [   1    0    5    5    1    3    0    0  957    2]
 [   2    0    0    2    5    4    0    1    2  993]]

##########
Iteration: 9
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_8880phca --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 127.59891533851624
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 82.81687045097351
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.63770270347595
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.9560229445506718, 'label_5': 0.8168822328114334, 'label_15': 1.2422360248447228, 'label_8': 0.7805325987144118, 'label_6': 1.1792452830188704, 'label_9': 1.129234629861986, 'label_13': 0.9852216748768461, 'label_7': 0.9667024704618665, 'label_10': 1.298099211868331, 'label_11': 1.339046598821636, 'label_12': 0.8911521323997418, 'label_14': 0.5244755244755206, 'label_4': 1.2422360248447228, 'label_3': 1.3182674199623379, 'label_2': 0.6031363088057851, 'label_16': 0.3931847968545177, 'label_17': 1.0570824524312905, 'label_0': 1.6129032258064502, 'label_18': 1.1857707509881465}
Component: exploration, run time: 55.29653859138489
Performing exploitation...
Component: exploitation, run time: 29.295881032943726
Running testing for iteration: 9...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9877
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 9 test accuracy:
	End-to-end: 0.9754
	Network(s): {'digit': 0.9877}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 972    1    1    0    1    0    0    1    0    4]
 [   0 1130    2    1    0    0    1    0    0    1]
 [   1    2 1018    0    2    0    0    7    2    0]
 [   0    0    4  994    0    5    0    1    4    2]
 [   0    0    0    0  969    0    1    0    0   12]
 [   2    0    0    4    0  884    2    0    0    0]
 [   6    2    0    0    7    2  937    0    4    0]
 [   0    2    1    0    0    1    0 1014    1    9]
 [   1    0    1    3    0    1    0    1  966    1]
 [   1    0    0    0    3    7    0    1    4  993]]

##########
Iteration: 10
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_cw9lt0xv --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 109.60029006004333
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 82.6275463104248
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.58868169784546
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.7648183556405397, 'label_5': 0.2722940776038074, 'label_15': 1.1387163561076608, 'label_8': 0.5509641873278182, 'label_6': 0.8254716981132115, 'label_9': 0.8364700961940641, 'label_13': 0.49261083743842304, 'label_7': 0.7518796992481258, 'label_10': 0.649049605934171, 'label_11': 0.6427423674343902, 'label_12': 0.5728835136855515, 'label_14': 0.34965034965035446, 'label_4': 0.709849157054121, 'label_3': 0.941619585687381, 'label_2': 0.3618817852834688, 'label_16': 0.2621231979030192, 'label_17': 1.0570824524312905, 'label_0': 0.8064516129032251, 'label_18': 0.39525691699604515}
Component: exploration, run time: 55.44972562789917
Performing exploitation...
Component: exploitation, run time: 27.9343683719635
Running testing for iteration: 10...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9872
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 10 test accuracy:
	End-to-end: 0.9744
	Network(s): {'digit': 0.9872}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 965    2    2    0    1    1    0    4    0    5]
 [   0 1130    1    1    0    0    1    1    1    0]
 [   1    1 1023    0    0    0    1    4    2    0]
 [   0    0    8  989    0    5    0    2    5    1]
 [   0    0    1    0  974    0    2    0    0    5]
 [   2    0    0    4    0  883    1    0    1    1]
 [   4    3    1    0    1    5  941    0    2    1]
 [   0    2    3    0    0    0    0 1015    1    7]
 [   1    0    3    1    1    2    0    1  963    2]
 [   0    0    0    0    5    7    0    5    3  989]]

##########
Iteration: 11
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_x325jems --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 79.1854248046875
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 85.59838676452637
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.340818881988525
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.3824091778202643, 'label_5': 0.6126616746085722, 'label_15': 0.6211180124223614, 'label_8': 0.36730945821854544, 'label_6': 0.7665094339622591, 'label_9': 0.4182350480970265, 'label_13': 0.49261083743842304, 'label_7': 0.5907626208378036, 'label_10': 0.6954102920723182, 'label_11': 0.6427423674343902, 'label_12': 0.3182686187141903, 'label_14': 0.43706293706293753, 'label_4': 0.2661934338953009, 'label_3': 0.7532956685499026, 'label_2': 0.4825090470446325, 'label_16': 0.2621231979030192, 'label_17': 0.6342494714587699, 'label_0': 0.0, 'label_18': 0.39525691699604515}
Component: exploration, run time: 52.713319301605225
Performing exploitation...
Component: exploitation, run time: 28.878555297851562
Running testing for iteration: 11...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.989
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 11 test accuracy:
	End-to-end: 0.978
	Network(s): {'digit': 0.989}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 975    1    0    0    0    1    0    3    0    0]
 [   0 1129    1    2    0    0    1    0    1    1]
 [   3    0 1016    0    1    0    1    9    2    0]
 [   0    0    4  999    0    3    0    0    3    1]
 [   0    0    0    0  975    0    2    0    0    5]
 [   2    0    0    4    0  883    2    0    0    1]
 [   6    3    0    0    2    5  941    0    1    0]
 [   0    3    5    1    0    0    0 1011    1    7]
 [   1    0    1    2    0    2    0    0  967    1]
 [   1    0    0    1    6    3    0    1    3  994]]

##########
Iteration: 12
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file__kbesyqe --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 114.26509523391724
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 85.4782075881958
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.551746129989624
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.3824091778202643, 'label_5': 0.47651463580666853, 'label_15': 1.7598343685300222, 'label_8': 0.7805325987144118, 'label_6': 0.4716981132075526, 'label_9': 1.1710581346716875, 'label_13': 0.6333567909922566, 'label_7': 0.42964554242749253, 'label_10': 1.066295781177562, 'label_11': 0.9105516871987129, 'label_12': 1.2730744748567835, 'label_14': 0.8741258741258751, 'label_4': 0.709849157054121, 'label_3': 0.28248587570621764, 'label_2': 0.0, 'label_16': 1.4416775884665833, 'label_17': 2.5369978858350906, 'label_0': 0.0, 'label_18': 0.39525691699604515}
Component: exploration, run time: 56.113917112350464
Performing exploitation...
Component: exploitation, run time: 28.540741443634033
Running testing for iteration: 12...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9861
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 12 test accuracy:
	End-to-end: 0.9722
	Network(s): {'digit': 0.9861}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 974    2    1    0    0    0    0    3    0    0]
 [   0 1133    1    0    0    0    1    0    0    0]
 [   0    1 1026    0    0    0    1    3    1    0]
 [   1    0    7  993    0    4    0    3    1    1]
 [   0    0    2    0  973    0    2    0    0    5]
 [   3    0    0    5    0  882    1    1    0    0]
 [   7    3    2    0    1    4  941    0    0    0]
 [   0    3    9    0    0    0    0 1015    0    1]
 [   1    0   15    4    2    5    0    5  941    1]
 [   1    0    0    0    7    6    0    9    3  983]]

##########
Iteration: 13
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_jjzafnrz --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 117.49073600769043
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 82.02057433128357
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.27681088447571
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.3824091778202643, 'label_5': 0.3403675970047648, 'label_15': 0.6211180124223614, 'label_8': 0.45913682277318735, 'label_6': 0.7665094339622591, 'label_9': 0.5018820577164407, 'label_13': 0.703729767769179, 'label_7': 0.26852846401718145, 'label_10': 0.37088548910524377, 'label_11': 0.5891805034815234, 'label_12': 0.5092297899427112, 'label_14': 0.6118881118881148, 'label_4': 0.2661934338953009, 'label_3': 0.47080979284369606, 'label_2': 0.0, 'label_16': 0.3931847968545177, 'label_17': 0.8456659619450302, 'label_0': 0.0, 'label_18': 1.1857707509881465}
Component: exploration, run time: 55.289464712142944
Performing exploitation...
Component: exploitation, run time: 28.2387478351593
Running testing for iteration: 13...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9891
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 13 test accuracy:
	End-to-end: 0.9782
	Network(s): {'digit': 0.9891}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 973    2    0    0    0    1    1    2    0    1]
 [   0 1129    1    2    0    0    1    0    1    1]
 [   1    1 1023    1    2    0    0    2    2    0]
 [   0    0    5  996    0    4    0    1    4    0]
 [   0    0    0    0  976    0    1    0    0    5]
 [   2    0    0    4    0  884    1    0    0    1]
 [   6    2    0    0    2    4  943    0    1    0]
 [   0    2    5    0    0    1    0 1011    1    8]
 [   1    0    1    4    1    2    0    0  963    2]
 [   1    0    0    0    7    1    0    4    3  993]]

##########
Iteration: 14
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_fu7vn57y --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 117.45570802688599
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 81.88825511932373
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.222840309143066
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.19120458891013214, 'label_5': 0.3403675970047648, 'label_15': 0.10351966873706209, 'label_8': 0.4132231404958664, 'label_6': 0.6485849056603765, 'label_9': 0.46005855290672804, 'label_13': 0.14074595355383357, 'label_7': 0.3759398496240629, 'label_10': 0.2781641168289273, 'label_11': 0.4284949116229231, 'label_12': 0.3182686187141903, 'label_14': 0.17482517482517723, 'label_4': 0.4436557231588312, 'label_3': 0.5649717514124242, 'label_2': 0.12062726176115257, 'label_16': 0.2621231979030192, 'label_17': 0.0, 'label_0': 0.0, 'label_18': 0.0}
Component: exploration, run time: 55.41322350502014
Performing exploitation...
Component: exploitation, run time: 28.24317717552185
Running testing for iteration: 14...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9896
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 14 test accuracy:
	End-to-end: 0.9792
	Network(s): {'digit': 0.9896}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 975    2    1    0    0    0    1    1    0    0]
 [   0 1131    0    0    0    0    1    1    1    1]
 [   1    0 1025    0    1    0    0    2    3    0]
 [   0    0    7  989    0    6    0    2    5    1]
 [   0    0    0    0  975    0    1    0    0    6]
 [   2    0    0    2    0  886    2    0    0    0]
 [   8    2    2    0    1    1  943    0    1    0]
 [   0    3    5    0    0    0    0 1016    1    3]
 [   1    0    1    1    1    2    0    0  967    1]
 [   1    0    0    0    5    2    0    7    5  989]]

##########
Iteration: 15
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_g5tff9l4 --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 133.79123950004578
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 82.99579501152039
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.02085590362549
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.19120458891013214, 'label_5': 0.0, 'label_15': 0.10351966873706209, 'label_8': 0.09182736455464191, 'label_6': 0.3537735849056589, 'label_9': 0.46005855290672804, 'label_13': 0.28149190710766714, 'label_7': 0.1611170784103111, 'label_10': 0.18544274455262189, 'label_11': 0.3749330476700563, 'label_12': 0.25461489497136114, 'label_14': 0.2622377622377603, 'label_4': 0.2661934338953009, 'label_3': 0.0, 'label_2': 0.12062726176115257, 'label_16': 0.0, 'label_17': 0.21141649048626032, 'label_0': 0.0, 'label_18': 0.7905138339920903}
Component: exploration, run time: 57.47553324699402
Performing exploitation...
Component: exploitation, run time: 29.220170736312866
Running testing for iteration: 15...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9899
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 15 test accuracy:
	End-to-end: 0.9798
	Network(s): {'digit': 0.9899}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 977    1    0    0    0    0    1    1    0    0]
 [   0 1130    0    2    0    0    1    0    1    1]
 [   1    0 1025    1    2    0    0    2    1    0]
 [   0    0    3 1000    0    2    0    0    3    2]
 [   0    0    0    0  977    0    2    0    0    3]
 [   2    0    0    5    0  883    1    0    1    0]
 [   7    1    1    0    1    4  943    0    1    0]
 [   0    3    5    0    0    0    0 1016    0    4]
 [   1    0    1    4    1    3    0    1  961    2]
 [   1    0    0    1    7    4    0    6    3  987]]

##########
Iteration: 16
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_df7u8qrn --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 119.17466425895691
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 83.5103268623352
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 36.99619722366333
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.3824091778202643, 'label_5': 0.2722940776038074, 'label_15': 0.6211180124223614, 'label_8': 0.45913682277318735, 'label_6': 0.3537735849056589, 'label_9': 0.6273525721455453, 'label_13': 0.7741027445460902, 'label_7': 0.26852846401718145, 'label_10': 0.5099675475197074, 'label_11': 0.5891805034815234, 'label_12': 0.4455760661998709, 'label_14': 0.786713286713292, 'label_4': 0.6211180124223614, 'label_3': 0.37664783427495685, 'label_2': 0.3618817852834688, 'label_16': 0.5242463958060273, 'label_17': 0.21141649048626032, 'label_0': 0.0, 'label_18': 0.39525691699604515}
Component: exploration, run time: 56.60086679458618
Performing exploitation...
Component: exploitation, run time: 28.400593757629395
Running testing for iteration: 16...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.989
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 16 test accuracy:
	End-to-end: 0.978
	Network(s): {'digit': 0.989}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 975    2    0    0    0    1    1    1    0    0]
 [   0 1131    0    1    0    0    1    1    0    1]
 [   1    2 1021    1    1    0    0    4    2    0]
 [   0    0    5  992    0    6    0    1    4    2]
 [   0    0    0    0  976    0    0    0    0    6]
 [   2    0    0    3    0  885    1    0    1    0]
 [   5    3    0    0    5    3  938    0    3    1]
 [   0    2    4    0    0    1    0 1013    0    8]
 [   1    0    1    3    1    2    0    0  964    2]
 [   0    0    0    0    5    4    0    2    3  995]]

##########
Iteration: 17
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_gwlhw50k --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 135.9135296344757
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 84.99278163909912
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.64715933799744
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.5736137667303964, 'label_5': 0.2722940776038074, 'label_15': 0.31055900621117516, 'label_8': 0.36730945821854544, 'label_6': 0.4716981132075526, 'label_9': 0.6691760769552468, 'label_13': 0.5629838142153454, 'label_7': 0.21482277121375182, 'label_10': 0.6954102920723182, 'label_11': 0.32137118371718953, 'label_12': 0.4455760661998709, 'label_14': 0.786713286713292, 'label_4': 0.5323868677905907, 'label_3': 0.09416195856873921, 'label_2': 0.12062726176115257, 'label_16': 0.6553079947575369, 'label_17': 1.0570824524312905, 'label_0': 0.0, 'label_18': 0.39525691699604515}
Component: exploration, run time: 54.046210289001465
Performing exploitation...
Component: exploitation, run time: 28.95122504234314
Running testing for iteration: 17...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9888
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 17 test accuracy:
	End-to-end: 0.9776
	Network(s): {'digit': 0.9888}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 974    1    1    0    0    1    0    2    0    1]
 [   1 1132    0    0    0    0    1    0    0    1]
 [   0    2 1020    4    0    0    1    4    1    0]
 [   0    0    2 1003    0    1    0    1    3    0]
 [   0    0    2    0  975    0    1    1    0    3]
 [   2    0    0    6    0  883    1    0    0    0]
 [   5    2    1    0    2    7  940    0    1    0]
 [   0    3    3    0    0    0    0 1018    1    3]
 [   1    0    1    8    1    7    0    1  953    2]
 [   0    0    0    0    5    5    0    6    3  990]]

##########
Iteration: 18
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_26v0ucoh --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 119.39697313308716
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 84.20666837692261
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 38.018375635147095
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.3824091778202643, 'label_5': 0.0, 'label_15': 0.8281573498964856, 'label_8': 0.5050505050505083, 'label_6': 0.9433962264150941, 'label_9': 0.6273525721455453, 'label_13': 0.703729767769179, 'label_7': 0.8592910848549962, 'label_10': 0.5099675475197074, 'label_11': 0.5891805034815234, 'label_12': 0.3182686187141903, 'label_14': 0.43706293706293753, 'label_4': 0.5323868677905907, 'label_3': 0.18832391713747842, 'label_2': 0.24125452352231624, 'label_16': 0.3931847968545177, 'label_17': 0.6342494714587699, 'label_0': 0.0, 'label_18': 0.39525691699604515}
Component: exploration, run time: 55.414883852005005
Performing exploitation...
Component: exploitation, run time: 29.41970729827881
Running testing for iteration: 18...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9881
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 18 test accuracy:
	End-to-end: 0.9762
	Network(s): {'digit': 0.9881}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 979    0    0    0    0    0    0    1    0    0]
 [   2 1128    0    1    0    0    0    3    0    1]
 [   1    1 1025    0    0    0    1    3    1    0]
 [   0    0    5  993    0    6    0    2    4    0]
 [   0    0    2    0  972    0    3    0    0    5]
 [   2    0    0    4    0  884    1    1    0    0]
 [  12    3    1    0    1    8  932    0    1    0]
 [   0    2    4    0    0    0    0 1019    1    2]
 [   3    0    1    2    3    7    0    1  955    2]
 [   1    0    0    0    5    1    0    5    3  994]]

##########
Iteration: 19
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_rwu4m6gj --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 125.87827348709106
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V0 + V1, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 85.08161044120789
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.91267251968384
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 1.3384321223709361, 'label_5': 0.5445881552076259, 'label_15': 0.7246376811594235, 'label_8': 0.45913682277318735, 'label_6': 0.8844339622641528, 'label_9': 0.6691760769552468, 'label_13': 0.5629838142153454, 'label_7': 0.8055853920515554, 'label_10': 0.5099675475197074, 'label_11': 0.26780931976432276, 'label_12': 0.3819223424570306, 'label_14': 0.43706293706293753, 'label_4': 0.8873114463176623, 'label_3': 0.47080979284369606, 'label_2': 0.7237635705669487, 'label_16': 0.2621231979030192, 'label_17': 0.6342494714587699, 'label_0': 0.8064516129032251, 'label_18': 0.0}
Component: exploration, run time: 56.262704372406006
Performing exploitation...
Component: exploitation, run time: 28.12854313850403
Running testing for iteration: 19...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.9878
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 19 test accuracy:
	End-to-end: 0.9758
	Network(s): {'digit': 0.9878}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 975    1    2    0    0    1    0    1    0    0]
 [   0 1124    0    3    0    3    3    1    1    0]
 [   2    0 1022    2    0    0    2    2    2    0]
 [   0    0    5  993    0    6    0    1    4    1]
 [   0    0    2    0  970    0    2    0    0    8]
 [   2    0    0    1    0  889    0    0    0    0]
 [   7    2    0    1    2    3  942    0    1    0]
 [   1    2    7    0    0    0    0 1012    1    5]
 [   0    0    1    3    2    3    0    0  964    1]
 [   2    0    0    0    8    4    0    3    5  987]]

##########
Iteration: 20
##########
Running ILP system with command: 
/u/dantc93/NSL_End_to_End/FastLAS /tmp/NSIL_tmp_file_p7f07phw --solver="ASP" --fl2 --threads 128 --read-cache results/repeats/sum/100/5/LAS_cache/fastlas_cache
Learned hypothesis:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Component: ILP, run time: 119.75455117225647
Converted hypothesis for neural-symbolic reasoning:
solution(V0,V1,V2) :- V2 = V1 + V0, digit_type(V0), digit_type(V1), num(V2).

Starting neural network training for 1 epoch(s)...
Component: nn_training, run time: 81.90315008163452
Evaluating neural network digit on the train set
Starting symbolic task evaluation for train set with preds type: nn.
Component: symbolic_train_nn_preds_eval, run time: 37.90948009490967
Performing exploration... 
False Negative Rate for each label/structure combination:
{'label_1': 0.0, 'label_5': 0.4084411164057222, 'label_15': 0.6211180124223614, 'label_8': 0.5509641873278182, 'label_6': 0.5306603773584939, 'label_9': 0.7528230865746499, 'label_13': 0.9852216748768461, 'label_7': 0.6444683136412444, 'label_10': 0.9735744089012566, 'label_11': 0.7498660953401126, 'label_12': 0.6365372374283917, 'label_14': 0.5244755244755206, 'label_4': 0.709849157054121, 'label_3': 0.7532956685499026, 'label_2': 0.24125452352231624, 'label_16': 0.5242463958060273, 'label_17': 1.0570824524312905, 'label_0': 0.8064516129032251, 'label_18': 0.0}
Component: exploration, run time: 55.82787799835205
Performing exploitation...
Component: exploitation, run time: 29.090312004089355
Running testing for iteration: 20...
Evaluating neural network digit on the test set
Accuracy for neural network digit: 0.988
Starting symbolic task evaluation for test set with preds type: nn.
Starting symbolic task evaluation for test set with preds type: ground.
Iteration 20 test accuracy:
	End-to-end: 0.9762
	Network(s): {'digit': 0.988}
	Hypothesis: 1.0
Confusion matrix for network digit:
[[ 972    2    0    0    0    1    3    2    0    0]
 [   0 1132    0    1    0    0    1    0    0    1]
 [   1    1 1020    3    1    0    2    2    2    0]
 [   0    0    4 1000    0    6    0    0    0    0]
 [   0    0    1    0  960    1    3    0    0   17]
 [   2    0    0    2    0  887    1    0    0    0]
 [   2    2    0    0    1    3  950    0    0    0]
 [   0    3    4    2    0    0    0 1010    1    8]
 [   1    0    1    3    0    7    1    0  959    2]
 [   0    0    0    0    5    8    0    3    3  990]]
